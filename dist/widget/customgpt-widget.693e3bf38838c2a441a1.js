!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CustomGPTWidget=t():e.CustomGPTWidget=t()}(this,()=>(()=>{"use strict";var e,t={9909:(e,t,s)=>{s.r(t),s.d(t,{CustomGPTWidget:()=>Fe,CustomGPTWidgetAPI:()=>$e,default:()=>De});var n=s(758),r=s(9576),a=s(1681),i=s(472),o=s(467),l=s(3526),c=s(4799);s(8404);function d(...e){return(0,c.QP)((0,l.$)(e))}function m(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function h(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}function g(e){const t=new Date(e),s=(new Date).getTime()-t.getTime(),n=Math.floor(s/6e4),r=Math.floor(s/36e5),a=Math.floor(s/864e5);return n<1?"Just now":n<60?`${n}m ago`:r<24?`${r}h ago`:a<7?`${a}d ago`:t.toLocaleDateString()}async function u(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return!1}}function x(e){try{if(e.startsWith("data: ")){const t=e.slice(6);return"[DONE]"===t?{type:"done"}:JSON.parse(t)}return null}catch(e){return null}}function p(e){return new Promise(t=>setTimeout(t,e))}const f={MAX_FILE_SIZE:10485760,ACCEPTED_FILE_TYPES:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","text/csv","application/json","application/xml","image/jpeg","image/png","image/gif","image/webp"],MAX_MESSAGE_LENGTH:4e3,API_TIMEOUT:3e4,STREAM_TIMEOUT:6e4,RETRY_ATTEMPTS:3,RETRY_DELAY:1e3};function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class b{constructor(e){y(this,"baseURL",void 0),y(this,"apiKey",void 0),y(this,"timeout",void 0),y(this,"retryAttempts",void 0),y(this,"retryDelay",void 0),y(this,"abortControllers",new Map),this.apiKey=e.apiKey,this.baseURL=e.baseURL||"https://app.customgpt.ai/api/v1",this.timeout=e.timeout||3e4,this.retryAttempts=e.retryAttempts||3,this.retryDelay=e.retryDelay||1e3}async request(e,t={}){const{timeout:s=this.timeout,retryAttempts:n=this.retryAttempts,params:r,...a}=t,i=new URL(`${this.baseURL}${e}`);r&&Object.entries(r).forEach(([e,t])=>{null!=t&&i.searchParams.append(e,t.toString())});const o={Authorization:`Bearer ${this.apiKey}`,...a.headers};a.body instanceof FormData||(o["Content-Type"]="application/json");const l={...a,headers:o};return async function(e,t=3,s=1e3){let n;for(let r=1;r<=t;r++)try{return await e()}catch(e){if(n=e,r===t)throw n;const a=s*Math.pow(2,r-1);await p(a)}throw n}(async()=>{const e=new AbortController,t=this.generateRequestId();this.abortControllers.set(t,e);const n=setTimeout(()=>{e.abort()},s);try{const s=await fetch(i.toString(),{...l,signal:e.signal});if(clearTimeout(n),this.abortControllers.delete(t),!s.ok){const e=await s.text();let t;try{const s=JSON.parse(e);t=s.message||s.error||"Unknown error"}catch{t=e||`HTTP ${s.status}`}throw new v(s.status,t)}return await s.json()}catch(e){if(clearTimeout(n),this.abortControllers.delete(t),e instanceof v)throw e;if(e instanceof Error&&"AbortError"===e.name)throw new v(408,"Request timeout");throw new v(0,e instanceof Error?e.message:"Network error")}},n,this.retryDelay)}async streamRequest(e,t={},s={}){const{timeout:n=6e4,params:r,...a}=t,{onChunk:i,onComplete:o,onError:l}=s,c=new URL(`${this.baseURL}${e}`);c.searchParams.append("stream","true"),r&&Object.entries(r).forEach(([e,t])=>{null!=t&&c.searchParams.append(e,t.toString())});const d=new AbortController,m=this.generateRequestId();this.abortControllers.set(m,d);const h=setTimeout(()=>{d.abort()},n);try{const e=await fetch(c.toString(),{...a,headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json",Accept:"text/event-stream",...a.headers},signal:d.signal});if(!e.ok){const t=await e.text();throw new v(e.status,t)}const t=e.body?.getReader();if(!t)throw new v(500,"No response body");const s=new TextDecoder;let n="";try{for(;;){const{done:e,value:r}=await t.read();if(e){o?.();break}n+=s.decode(r,{stream:!0});const a=n.split("\n");n=a.pop()||"";for(const e of a)if(e.trim()){const t=x(e);if(t){if("done"===t.type)return void o?.();if("error"===t.type)return void l?.(new Error(t.error||"Stream error"));i?.(t)}}}}finally{t.releaseLock()}}catch(e){e instanceof v?l?.(e):e instanceof Error&&"AbortError"===e.name?l?.(new v(408,"Request timeout")):l?.(new v(0,e instanceof Error?e.message:"Network error"))}finally{clearTimeout(h),this.abortControllers.delete(m)}}cancelRequest(e){const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))}cancelAllRequests(){this.abortControllers.forEach(e=>e.abort()),this.abortControllers.clear()}generateRequestId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}async getAgents(e){return this.request("/projects",{params:e})}async getAgent(e){return this.request(`/projects/${e}`)}async createAgent(e){const t=new FormData;return Object.entries(e).forEach(([e,s])=>{void 0!==s&&t.append(e,s instanceof File?s:s.toString())}),this.request("/projects",{method:"POST",body:t})}async updateAgent(e,t){return this.request(`/projects/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteAgent(e){return this.request(`/projects/${e}`,{method:"DELETE"})}async getAgentSettings(e){return this.request(`/projects/${e}/settings`)}async updateAgentSettings(e,t){return this.request(`/projects/${e}/settings`,{method:"POST",body:JSON.stringify(t)})}async getConversations(e,t){return this.request(`/projects/${e}/conversations`,{params:t})}async createConversation(e,t){return this.request(`/projects/${e}/conversations`,{method:"POST",body:JSON.stringify(t)})}async updateConversation(e,t,s){return this.request(`/projects/${e}/conversations/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteConversation(e,t){return this.request(`/projects/${e}/conversations/${t}`,{method:"DELETE"})}async getMessages(e,t,s){return this.request(`/projects/${e}/conversations/${t}/messages`,{params:s})}async sendMessage(e,t,s){return this.request(`/projects/${e}/conversations/${t}/messages`,{method:"POST",body:JSON.stringify(s)})}async sendMessageStream(e,t,s,n){return this.streamRequest(`/projects/${e}/conversations/${t}/messages`,{method:"POST",body:JSON.stringify(s)},n)}async updateMessageFeedback(e,t,s,n){return this.request(`/projects/${e}/conversations/${t}/messages/${s}/feedback`,{method:"PUT",body:JSON.stringify(n)})}async getCitation(e,t){return this.request(`/projects/${e}/citations/${t}`)}async getSources(e){return this.request(`/projects/${e}/sources`)}async uploadFile(e,t,s){const n=new FormData;return n.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{void 0!==t&&n.append(e,t.toString())}),this.request(`/projects/${e}/sources`,{method:"POST",body:n})}}class v extends Error{constructor(e,t,s,n){super(t),this.status=e,this.code=s,this.details=n,this.name="APIError"}}let j=null;function w(){if(!j)throw new Error("API client not initialized. Call initializeClient() first.");return j}function N(e){return j=new b(e),j}const C=(0,i.vt)()((0,o.Zr)((e,t)=>({apiKey:null,baseURL:"https://app.customgpt.ai/api/v1",theme:"light",setApiKey:s=>{e({apiKey:s}),s&&N({apiKey:s,baseURL:t().baseURL})},setBaseURL:s=>{e({baseURL:s});const{apiKey:n}=t();n&&N({apiKey:n,baseURL:s})},setTheme:t=>{e({theme:t}),"undefined"!=typeof window&&(document.documentElement.className=t)}}),{name:"customgpt-config",partialize:e=>({apiKey:e.apiKey,baseURL:e.baseURL,theme:e.theme}),onRehydrateStorage:()=>e=>{e?.apiKey&&null===j&&N({apiKey:e.apiKey,baseURL:e.baseURL}),e?.theme&&"undefined"!=typeof window&&(document.documentElement.className=e.theme)}})),S=(0,i.vt)()((0,o.Zr)((e,t)=>({agents:[],currentAgent:null,loading:!1,error:null,fetchAgents:async()=>{e({loading:!0,error:null});try{const s=w(),n=await s.getAgents();let r=[];n&&"object"==typeof n&&(Array.isArray(n.data)?r=n.data:Array.isArray(n)?r=n:n.data&&Array.isArray(n.data.data)&&(r=n.data.data)),e({agents:r,loading:!1,currentAgent:t().currentAgent||(r.length>0?r[0]:null)})}catch(t){e({agents:[],error:t instanceof Error?t.message:"Failed to fetch agents",loading:!1})}},selectAgent:t=>{e({currentAgent:t})},setAgents:s=>{e({agents:s,currentAgent:(()=>{const e=t().currentAgent;if(!e)return s.length>0?s[0]:null;return s.find(t=>t.id===e.id)||(s.length>0?s[0]:null)})()})}}),{name:"customgpt-agents",partialize:e=>({currentAgent:e.currentAgent})})),A=(0,i.vt)()((0,o.Zr)((e,t)=>({conversations:[],currentConversation:null,loading:!1,error:null,fetchConversations:async t=>{e({loading:!0,error:null});try{const s=w(),n=(await s.getConversations(t)).data||[];e({conversations:n,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch conversations",loading:!1})}},createConversation:async(t,s)=>{e({loading:!0,error:null});try{const n=w(),r=(await n.createConversation(t,{name:s})).data;e(e=>({conversations:[r,...e.conversations],currentConversation:r,loading:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"Failed to create conversation",loading:!1}),t}},selectConversation:t=>{e({currentConversation:t})},deleteConversation:async s=>{const{conversations:n,currentConversation:r}=t(),a=n.find(e=>e.id===s);if(a){e({loading:!0,error:null});try{const t=w();await t.deleteConversation(a.project_id,s);const i=n.filter(e=>e.id!==s);e({conversations:i,currentConversation:r?.id===s?i.length>0?i[0]:null:r,loading:!1})}catch(t){throw e({error:t instanceof Error?t.message:"Failed to delete conversation",loading:!1}),t}}},ensureConversation:async(s,n)=>{const{currentConversation:r,conversations:a}=t();if(r&&r.project_id===s)return r;const i=a.filter(e=>e.project_id===s);if(i.length>0){const t=i[0];return e({currentConversation:t}),t}const o=n?function(e){const t=e.trim().split(/\s+/).slice(0,6).join(" ");return t.length>50?t.substring(0,50).trim()+"...":t}(n):`Chat ${(new Date).toLocaleDateString()}`;return await t().createConversation(s,o),t().currentConversation}}),{name:"customgpt-conversations",partialize:e=>({currentConversation:e.currentConversation})}));function E(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class k{constructor(e={}){E(this,"config",void 0),E(this,"abortController",null),E(this,"currentMessage",null),this.config={timeout:e.timeout||6e4,retryAttempts:e.retryAttempts||3,retryDelay:e.retryDelay||1e3}}async processStream(e,t){this.abortController=new AbortController,this.currentMessage={id:this.generateId(),content:"",citations:[],isComplete:!1};const s=e.getReader(),n=new TextDecoder;let r="";const a=setTimeout(()=>{this.cancel(),t.onError?.(new Error("Stream timeout"))},this.config.timeout);try{for(;;){const{done:e,value:a}=await s.read();if(e){this.currentMessage.isComplete=!0,t.onComplete?.();break}r+=n.decode(a,{stream:!0});const i=r.split("\n");r=i.pop()||"";for(const e of i)e.trim()&&await this.processLine(e,t)}}catch(e){e instanceof Error&&"AbortError"===e.name?t.onError?.(new Error("Stream cancelled")):t.onError?.(e instanceof Error?e:new Error("Unknown streaming error"))}finally{clearTimeout(a),s.releaseLock(),this.abortController=null}return this.currentMessage}async processLine(e,t){const s=x(e);if(s&&this.currentMessage)switch(s.type){case"content":s.content&&(this.currentMessage.content+=s.content,t.onChunk?.(s.content));break;case"citation":s.citations&&(this.currentMessage.citations.push(...s.citations),s.citations.forEach(e=>{t.onCitation?.(e)}));break;case"done":return this.currentMessage.isComplete=!0,void t.onComplete?.();case"error":return void t.onError?.(new Error(s.error||"Stream error"))}}cancel(){this.abortController&&this.abortController.abort()}getCurrentMessage(){return this.currentMessage}isStreaming(){return null!==this.abortController&&null!==this.currentMessage&&!this.currentMessage.isComplete}generateId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}}const M=new class{constructor(e=3){E(this,"streams",new Map),E(this,"maxConcurrentStreams",void 0),this.maxConcurrentStreams=e}async startStream(e,t,s,n){if(this.streams.size>=this.maxConcurrentStreams)throw new Error(`Maximum concurrent streams (${this.maxConcurrentStreams}) reached`);this.streams.has(e)&&this.cancelStream(e);const r=new k(n);this.streams.set(e,r);try{return await r.processStream(t,{...s,onComplete:()=>{this.streams.delete(e),s.onComplete?.()},onError:t=>{this.streams.delete(e),s.onError?.(t)}})}catch(t){throw this.streams.delete(e),t}}cancelStream(e){const t=this.streams.get(e);t&&(t.cancel(),this.streams.delete(e))}cancelAllStreams(){this.streams.forEach(e=>e.cancel()),this.streams.clear()}getActiveStreams(){return Array.from(this.streams.keys())}getStreamStatus(e){const t=this.streams.get(e);return t?{exists:!0,isStreaming:t.isStreaming(),message:t.getCurrentMessage()}:{exists:!1,isStreaming:!1,message:null}}getActiveStreamCount(){return this.streams.size}},T=(0,i.vt)((e,t)=>({messages:new Map,streamingMessage:null,isStreaming:!1,loading:!1,error:null,sendMessage:async(s,n)=>{const r=S.getState(),a=A.getState(),{currentAgent:i}=r;if(!i)throw new Error("No agent selected");const o=await a.ensureConversation(i.id,s);e({loading:!0,error:null});const l={id:m(),role:"user",content:s,timestamp:(new Date).toISOString(),status:"sending"};t().addMessage(o.id,l);const c={id:m(),role:"assistant",content:"",timestamp:(new Date).toISOString(),citations:[]};e({streamingMessage:c,isStreaming:!0,loading:!1});try{if(n&&n.length>0){const e=w();await Promise.all(n.map(t=>e.uploadFile(i.id,t)))}l.status="sent",t().addMessage(o.id,l);const r=w();await r.sendMessageStream(i.id,o.id,{prompt:s},{onChunk:e=>{"content"===e.type&&e.content&&t().updateStreamingMessage(e.content,e.citations)},onComplete:()=>{const s=t().streamingMessage;s&&(s.status="sent",t().addMessage(o.id,s)),e({streamingMessage:null,isStreaming:!1})},onError:s=>{const n=t().streamingMessage;n&&(n.content="Sorry, I encountered an error while processing your message.",n.status="error",t().addMessage(o.id,n)),e({streamingMessage:null,isStreaming:!1,error:s.message})}})}catch(s){throw l.status="error",t().addMessage(o.id,l),e({streamingMessage:null,isStreaming:!1,error:s instanceof Error?s.message:"Failed to send message",loading:!1}),s}},addMessage:(t,s)=>{e(e=>{const n=new Map(e.messages),r=n.get(t)||[],a=r.findIndex(e=>e.id===s.id);return a>=0?r[a]=s:r.push(s),n.set(t,r),{messages:n}})},updateStreamingMessage:(t,s)=>{e(e=>e.streamingMessage?{streamingMessage:{...e.streamingMessage,content:e.streamingMessage.content+t,citations:s||e.streamingMessage.citations}}:e)},clearMessages:t=>{e(e=>{if(t){const s=new Map(e.messages);return s.delete(t),{messages:s}}return{messages:new Map}})},updateMessageFeedback:async(e,s)=>{const n=S.getState(),r=A.getState(),{currentAgent:a}=n,{currentConversation:i}=r;if(!a||!i)return;const o=(t().messages.get(i.id)||[]).find(t=>t.id===e);if(o)try{const e={...o,feedback:s};t().addMessage(i.id,e)}catch(e){t().addMessage(i.id,o)}},getMessagesForConversation:e=>t().messages.get(e)||[],cancelStreaming:()=>{M.cancelAllStreams(),e({streamingMessage:null,isStreaming:!1})},loadMessages:async t=>{const s=S.getState(),{currentAgent:n}=s;if(n){e({loading:!0,error:null});try{const s=w(),r=await s.getMessages(n.id,t),a=(r.data||[]).map(e=>({id:e.id,role:e.role,content:e.content,citations:e.citations||[],timestamp:e.timestamp,status:"sent",feedback:e.feedback}));e(e=>{const s=new Map(e.messages);return s.set(t,a),{messages:s,loading:!1}})}catch(t){e({error:t instanceof Error?t.message:"Failed to load messages",loading:!1})}}}}));(0,i.vt)()((0,o.Zr)(e=>({sidebarOpen:!0,settingsOpen:!1,theme:"light",fontSize:"md",setSidebarOpen:t=>{e({sidebarOpen:t})},setSettingsOpen:t=>{e({settingsOpen:t})},setTheme:t=>{e({theme:t}),"undefined"!=typeof window&&(document.documentElement.className=t)},setFontSize:t=>{if(e({fontSize:t}),"undefined"!=typeof window){const e=document.documentElement;switch(e.classList.remove("text-sm","text-base","text-lg"),t){case"sm":e.classList.add("text-sm");break;case"lg":e.classList.add("text-lg");break;default:e.classList.add("text-base")}}}}),{name:"customgpt-ui",partialize:e=>({sidebarOpen:e.sidebarOpen,theme:e.theme,fontSize:e.fontSize}),onRehydrateStorage:()=>e=>{if("undefined"!=typeof window&&e){document.documentElement.className=e.theme;const t=document.documentElement;switch(t.classList.remove("text-sm","text-base","text-lg"),e.fontSize){case"sm":t.classList.add("text-sm");break;case"lg":t.classList.add("text-lg");break;default:t.classList.add("text-base")}}}}));var P=s(2221),R=s(8077),O=s(9033),L=s(9400),z=s(9014),_=s(8080),F=s(3498),$=s(578),D=s(4347),I=s(8589),q=s(5368),U=s(2012),K=s(8637),G=s(846),B=s(6070);const Y=(0,G.F)("inline-flex items-center justify-center rounded-lg text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{variants:{variant:{default:"bg-brand-500 text-white hover:bg-brand-600 shadow-sm",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-sm",outline:"border border-gray-300 bg-white hover:bg-gray-50 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 text-gray-900",link:"text-brand-600 underline-offset-4 hover:underline"},size:{default:"h-10 py-2 px-4",sm:"h-8 px-3 text-xs",lg:"h-12 px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),J=n.forwardRef(({className:e,variant:t,size:s,asChild:n=!1,...r},a)=>(0,B.jsx)("button",{className:d(Y({variant:t,size:s,className:e})),ref:a,...r}));J.displayName="Button";var W=s(9716),Z=s(1912),H=s(4712);const X=({citation:e,index:t,isExpanded:s,onToggle:n,onClick:r})=>(0,B.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden transition-all hover:border-gray-300",children:[(0,B.jsxs)("button",{onClick:n,className:"w-full px-3 py-2 flex items-center gap-3 hover:bg-gray-50 transition-colors text-left",children:[(0,B.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded bg-brand-100 flex items-center justify-center",children:(0,B.jsx)("span",{className:"text-xs font-medium text-brand-700",children:t})}),(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsx)("div",{className:"font-medium text-sm text-gray-900 line-clamp-1",children:e.title}),(0,B.jsx)("div",{className:"text-xs text-gray-500 line-clamp-1",children:e.source||e.url})]}),(0,B.jsx)(Z.A,{className:d("w-4 h-4 text-gray-400 transition-transform flex-shrink-0",s&&"rotate-180")})]}),(0,B.jsx)(W.N,{children:s&&(0,B.jsx)(P.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,B.jsxs)("div",{className:"px-3 py-2 border-t border-gray-100 bg-gray-50",children:[(0,B.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:e.content}),e.confidence&&(0,B.jsxs)("div",{className:"mb-2",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[(0,B.jsx)("span",{children:"Relevance"}),(0,B.jsxs)("span",{children:[Math.round(100*e.confidence),"%"]})]}),(0,B.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,B.jsx)("div",{className:"bg-brand-500 h-1.5 rounded-full transition-all",style:{width:100*e.confidence+"%"}})})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[e.url&&(0,B.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-brand-600 hover:text-brand-700 transition-colors",children:["View source",(0,B.jsx)($.A,{className:"w-3 h-3"})]}),r&&(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:()=>r(e),className:"h-6 px-2 text-xs",children:"View details"})]})]})})})]}),V=({citations:e,onCitationClick:t,maxVisible:s=5,className:r})=>{const[a,i]=(0,n.useState)(new Set),[o,l]=(0,n.useState)(!1),c=o?e:e.slice(0,s),m=e.length>s;return 0===e.length?null:(0,B.jsxs)("div",{className:d("mt-4 space-y-2",r),children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,B.jsx)(H.A,{className:"w-4 h-4"}),(0,B.jsx)("span",{className:"font-medium",children:"Sources"}),(0,B.jsxs)("span",{className:"text-gray-400",children:["(",e.length,")"]}),m&&(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:()=>l(!o),className:"ml-auto h-6 px-2 text-xs",children:o?"Show less":`Show all ${e.length}`})]}),(0,B.jsx)("div",{className:"space-y-2",children:(0,B.jsx)(W.N,{children:c.map((e,s)=>(0,B.jsx)(P.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,delay:.05*s},children:(0,B.jsx)(X,{citation:e,index:s+1,isExpanded:a.has(e.id),onToggle:()=>(e=>{const t=new Set(a);a.has(e)?t.delete(e):t.add(e),i(t)})(e.id),onClick:t})},e.id))})}),m&&!o&&(0,B.jsx)("div",{className:"pt-2",children:(0,B.jsxs)(J,{size:"sm",variant:"outline",onClick:()=>l(!0),className:"w-full",children:["Show ",e.length-s," more sources"]})})]})},Q=({language:e,value:t})=>{const[s,r]=(0,n.useState)(!1);return(0,B.jsxs)("div",{className:"relative group",children:[(0,B.jsx)("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:async()=>{await u(t)&&(r(!0),a.oR.success("Code copied to clipboard"),setTimeout(()=>r(!1),2e3))},className:"h-6 px-2 text-xs bg-gray-800 text-white hover:bg-gray-700",children:s?"Copied!":"Copy"})}),(0,B.jsx)(_.A,{language:e,style:F.A,customStyle:{margin:0,borderRadius:"0.5rem",fontSize:"0.875rem"},children:t})]})},ee=()=>(0,B.jsx)("span",{className:"inline-block w-0.5 h-4 bg-gray-900 animate-blink ml-0.5 align-middle"}),te=({content:e,isStreaming:t})=>(0,B.jsxs)("div",{className:"prose prose-sm max-w-none text-gray-900",children:[(0,B.jsx)(L.oz,{remarkPlugins:[z.A],components:{code({className:e,children:t,...s}){const n=/language-(\w+)/.exec(e||"");return!!n&&n?(0,B.jsx)(Q,{language:n[1],value:String(t).replace(/\n$/,""),...s}):(0,B.jsx)("code",{className:"px-1 py-0.5 rounded bg-gray-100 text-sm font-medium",...s,children:t})},a:({href:e,children:t})=>(0,B.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:text-brand-700 no-underline hover:underline inline-flex items-center gap-1",children:[t,(0,B.jsx)($.A,{className:"w-3 h-3"})]})},children:e}),t&&(0,B.jsx)(ee,{})]}),se=({message:e,onFeedback:t})=>{const[s,r]=(0,n.useState)(e.feedback||null),i=e=>{r(e),t?.(e),a.oR.success("Thanks for your feedback!")};return(0,B.jsxs)("div",{className:"mt-3 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:async()=>{await u(e.content)&&a.oR.success("Message copied to clipboard")},className:"h-8 w-8 text-gray-500 hover:text-gray-700",title:"Copy message",children:(0,B.jsx)(D.A,{className:"h-4 w-4"})}),(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:()=>i("like"),className:d("h-8 w-8 text-gray-500 hover:text-gray-700","like"===s&&"text-green-600 hover:text-green-700"),title:"Good response",children:(0,B.jsx)(I.A,{className:"h-4 w-4"})}),(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:()=>i("dislike"),className:d("h-8 w-8 text-gray-500 hover:text-gray-700","dislike"===s&&"text-red-600 hover:text-red-700"),title:"Bad response",children:(0,B.jsx)(q.A,{className:"h-4 w-4"})}),(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:()=>{a.oR.info("Regenerating response...")},className:"h-8 w-8 text-gray-500 hover:text-gray-700",title:"Regenerate response",children:(0,B.jsx)(U.A,{className:"h-4 w-4"})})]})},ne=({message:e,isStreaming:t=!1,isLast:s=!1,onCitationClick:n,onFeedback:r,className:a})=>{const i="user"===e.role;return(0,B.jsx)(P.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:d("group relative px-4 py-6 transition-colors",i?"bg-white":"bg-gray-50 border-y border-gray-100","hover:bg-opacity-80",a),children:(0,B.jsxs)("div",{className:"max-w-3xl mx-auto flex gap-4",children:[(0,B.jsx)("div",{className:"flex-shrink-0",children:i?(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center",children:(0,B.jsx)(K.A,{className:"w-4 h-4 text-white"})}):(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center",children:(0,B.jsx)(O.A,{className:"w-4 h-4 text-brand-600"})})}),(0,B.jsxs)("div",{className:"flex-1 overflow-hidden",children:[e.status&&"sent"!==e.status&&(0,B.jsxs)("div",{className:"mb-2 text-xs text-gray-500",children:["sending"===e.status&&"Sending...","error"===e.status&&(0,B.jsx)("span",{className:"text-red-500",children:"Failed to send"})]}),i?(0,B.jsx)("p",{className:"text-gray-900 whitespace-pre-wrap",children:e.content}):(0,B.jsx)(te,{content:e.content,isStreaming:t}),e.citations&&e.citations.length>0&&(0,B.jsx)(V,{citations:e.citations,onCitationClick:n}),(0,B.jsx)("div",{className:"mt-2 text-xs text-gray-400",children:g(e.timestamp)}),!i&&!t&&(0,B.jsx)(se,{message:e,onFeedback:r})]})]})})};var re=s(3429),ae=s(999),ie=s(2020),oe=s(5476),le=s(1016),ce=s(3897),de=s(7052);const me=({file:e,onRemove:t})=>{const s=function(e){const t=e.toLowerCase();return t.includes("pdf")?"📄":t.includes("image")?"🖼️":t.includes("video")?"🎥":t.includes("audio")?"🎵":t.includes("text")||t.includes("txt")?"📝":t.includes("word")||t.includes("doc")?"📄":t.includes("excel")||t.includes("sheet")?"📊":t.includes("powerpoint")||t.includes("presentation")?"📈":t.includes("zip")||t.includes("rar")?"🗜️":t.includes("json")?"📋":t.includes("csv")?"📊":"📎"}(e.type);return(0,B.jsxs)(P.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[(0,B.jsx)("div",{className:"text-gray-600",children:s}),(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,B.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[(0,B.jsx)("span",{children:h(e.size)}),"uploading"===e.status&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("span",{children:"•"}),(0,B.jsxs)("span",{children:[e.progress,"%"]})]}),"error"===e.status&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("span",{children:"•"}),(0,B.jsxs)("span",{className:"text-red-500 flex items-center gap-1",children:[(0,B.jsx)(ae.A,{className:"w-3 h-3"}),"Error"]})]})]})]}),"uploading"===e.status&&(0,B.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gray-200 rounded-b",children:(0,B.jsx)("div",{className:"h-full bg-brand-500 rounded-b transition-all duration-300",style:{width:`${e.progress}%`}})}),(0,B.jsx)("button",{onClick:t,className:"p-0.5 rounded hover:bg-gray-300 transition-colors",disabled:"uploading"===e.status,children:(0,B.jsx)(ie.A,{className:"w-3 h-3 text-gray-500"})})]})},he=({onUpload:e,disabled:t})=>{const s=(0,n.useRef)(null);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("input",{ref:s,type:"file",multiple:!0,accept:f.ACCEPTED_FILE_TYPES.join(","),onChange:t=>{const s=Array.from(t.target.files||[]);s.length>0&&(e(s),t.target.value="")},className:"hidden"}),(0,B.jsx)(J,{type:"button",size:"icon",variant:"ghost",onClick:()=>{s.current?.click()},disabled:t,className:"h-10 w-10 text-gray-600 hover:text-gray-800",title:"Upload files",children:(0,B.jsx)(oe.A,{className:"h-5 w-5"})})]})},ge=({onSend:e,disabled:t=!1,placeholder:s="Send a message...",maxLength:r=f.MAX_MESSAGE_LENGTH,className:i})=>{const[o,l]=(0,n.useState)(""),[c,g]=(0,n.useState)([]),[u,x]=(0,n.useState)(!1),p=(0,n.useRef)(null),y=(0,n.useCallback)(()=>{const e=p.current;if(e){e.style.height="auto";const t=e.scrollHeight,s=200;e.style.height=`${Math.min(t,s)}px`}},[]),b=s=>{if(s.preventDefault(),t)return;if(!o.trim()&&0===c.length)return;const n=c.filter(e=>"uploaded"===e.status).map(e=>new File([""],e.name,{type:e.type}));e(o.trim(),n),l(""),g([]),p.current&&(p.current.style.height="auto"),setTimeout(()=>{p.current?.focus()},0)},v=(0,n.useCallback)(e=>{const t=e.filter(e=>{return e.size>f.MAX_FILE_SIZE?(a.oR.error(`File "${e.name}" is too large. Maximum size is ${h(f.MAX_FILE_SIZE)}`),!1):(t=e.type,!!f.ACCEPTED_FILE_TYPES.some(e=>t.toLowerCase().includes(e.toLowerCase()))||(a.oR.error(`File type "${e.type}" is not supported`),!1));var t}).map(e=>({id:m(),name:e.name,size:e.size,type:e.type,status:"uploading",progress:0}));g(e=>[...e,...t]),t.forEach(e=>{j(e)})},[]),j=e=>{let t=0;const s=setInterval(()=>{t+=20*Math.random(),t>=100?(t=100,clearInterval(s),g(t=>t.map(t=>t.id===e.id?{...t,status:"uploaded",progress:100}:t))):g(s=>s.map(s=>s.id===e.id?{...s,progress:Math.round(t)}:s))},100)},{getRootProps:w,getInputProps:N,isDragActive:C}=(0,re.VB)({onDrop:v,noClick:!0,noKeyboard:!0,accept:f.ACCEPTED_FILE_TYPES.reduce((e,t)=>(e[t]=[],e),{}),maxSize:f.MAX_FILE_SIZE,onDragEnter:()=>x(!0),onDragLeave:()=>x(!1)}),S=!t&&(o.trim()||c.some(e=>"uploaded"===e.status));return(0,B.jsxs)("div",{...w(),className:d("border-t border-gray-200 bg-white px-4 py-3 relative",C&&"bg-brand-50",i),children:[(0,B.jsx)("input",{...N()}),(0,B.jsx)(W.N,{children:C&&(0,B.jsx)(P.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-brand-50 border-2 border-dashed border-brand-300 rounded-lg flex items-center justify-center z-10",children:(0,B.jsxs)("div",{className:"text-center",children:[(0,B.jsx)(le.A,{className:"w-8 h-8 text-brand-600 mx-auto mb-2"}),(0,B.jsx)("p",{className:"text-brand-700 font-medium",children:"Drop files here to upload"}),(0,B.jsx)("p",{className:"text-brand-600 text-sm",children:"Supports PDF, DOC, TXT, and more"})]})})}),(0,B.jsx)(W.N,{children:c.length>0&&(0,B.jsx)(P.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-2 flex flex-wrap gap-2",children:c.map(e=>(0,B.jsx)(me,{file:e,onRemove:()=>{return t=e.id,void g(e=>e.filter(e=>e.id!==t));var t}},e.id))})}),(0,B.jsxs)("form",{onSubmit:b,className:"flex items-end gap-2",children:[(0,B.jsx)(he,{onUpload:v,disabled:t}),(0,B.jsxs)("div",{className:"flex-1 relative",children:[(0,B.jsx)("textarea",{ref:p,value:o,onChange:e=>{const t=e.target.value;t.length<=r&&(l(t),y())},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b(e))},placeholder:s,disabled:t,rows:1,className:d("w-full resize-none rounded-lg border border-gray-300","px-3 py-2 pr-12","focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed","min-h-[44px] max-h-[200px]","placeholder:text-gray-500"),style:{height:"auto",overflowY:o.split("\n").length>5?"auto":"hidden"}}),o.length>0&&(0,B.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400 pointer-events-none",children:[o.length,"/",r]})]}),(0,B.jsx)(J,{type:"submit",size:"icon",disabled:!S,className:d("h-10 w-10 flex-shrink-0",t&&"animate-pulse"),title:t?"Stop generating":"Send message",children:t?(0,B.jsx)(ce.A,{className:"h-5 w-5"}):(0,B.jsx)(de.A,{className:"h-5 w-5"})})]}),(0,B.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500",children:[(0,B.jsx)("span",{children:"Press Enter to send, Shift+Enter for new line"}),(0,B.jsxs)("span",{children:["Supports ",f.ACCEPTED_FILE_TYPES.length,"+ file formats"]})]})]})},ue=({className:e})=>(0,B.jsx)("div",{className:d("px-4 py-6 bg-gray-50 border-y border-gray-100",e),children:(0,B.jsxs)("div",{className:"max-w-3xl mx-auto flex gap-4",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center flex-shrink-0",children:(0,B.jsx)(O.A,{className:"w-4 h-4 text-brand-600"})}),(0,B.jsxs)("div",{className:"flex items-center gap-1 py-2",children:[(0,B.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle"}),(0,B.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle delay-100"}),(0,B.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle delay-200"})]})]})});var xe=s(908),pe=s(871),fe=s(5294);const ye=({agent:e,isSelected:t,onSelect:s,onSettingsClick:n})=>(0,B.jsxs)("div",{className:d("flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors group","hover:bg-gray-50",t&&"bg-brand-50 hover:bg-brand-100"),onClick:()=>s(e),children:[(0,B.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,B.jsx)("div",{className:d("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",t?"bg-brand-600":"bg-gray-200"),children:(0,B.jsx)(O.A,{className:d("w-4 h-4",t?"text-white":"text-gray-600")})}),(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:e.project_name}),t&&(0,B.jsx)(xe.A,{className:"w-4 h-4 text-brand-600 flex-shrink-0"})]}),e.settings?.agent_capability&&(0,B.jsx)("p",{className:"text-sm text-gray-500 truncate mt-0.5",children:e.settings.agent_capability}),(0,B.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-400",children:[e.settings?.chatbot_model&&(0,B.jsxs)("span",{children:["Model: ",e.settings.chatbot_model]}),(0,B.jsxs)("span",{children:["Status: ",e.is_chat_active?"Active":"Inactive"]})]})]})]}),n&&(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),n(e)},className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 text-gray-400 hover:text-gray-600",title:"Agent Settings",children:(0,B.jsx)(pe.A,{className:"h-3 w-3"})})]}),be=({className:e,showSettings:t=!0,onSettingsClick:s})=>{const[r,i]=(0,n.useState)(!1),o=(0,n.useRef)(null),{agents:l,currentAgent:c,loading:m,error:h,fetchAgents:g,selectAgent:u}=S();(0,n.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};if(r)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r]);const x=async()=>{try{await g(),a.oR.success("Agents refreshed")}catch(e){a.oR.error("Failed to refresh agents")}},p=e=>{u(e),i(!1),a.oR.success(`Switched to ${e.project_name}`)};return m&&0===l.length?(0,B.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse"}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2"}),(0,B.jsx)("div",{className:"h-3 bg-gray-100 rounded animate-pulse w-3/4"})]})]})}):h&&0===l.length?(0,B.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:(0,B.jsx)(ae.A,{className:"w-4 h-4 text-red-600"})}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("p",{className:"text-sm text-red-600 font-medium",children:"Failed to load agents"}),(0,B.jsx)("p",{className:"text-xs text-red-500",children:h})]}),(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:x,className:"text-red-600 hover:text-red-700",children:(0,B.jsx)(fe.A,{className:"w-4 h-4"})})]})}):c||0!==l.length?(0,B.jsxs)("div",{className:d("relative",e),ref:o,children:[(0,B.jsx)("button",{onClick:()=>i(!r),className:d("w-full p-3 bg-white border rounded-lg text-left transition-colors","hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",r&&"ring-2 ring-brand-500 border-transparent"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-600 flex items-center justify-center flex-shrink-0",children:(0,B.jsx)(O.A,{className:"w-4 h-4 text-white"})}),(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:c?.project_name||"Select Agent"}),c?.settings?.agent_capability&&(0,B.jsx)("p",{className:"text-sm text-gray-500 truncate",children:c.settings.agent_capability})]})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:e=>{e.stopPropagation(),x()},disabled:m,className:"h-6 w-6 text-gray-400 hover:text-gray-600",title:"Refresh Agents",children:(0,B.jsx)(fe.A,{className:d("h-3 w-3",m&&"animate-spin")})}),(0,B.jsx)(Z.A,{className:d("w-4 h-4 text-gray-400 transition-transform",r&&"rotate-180")})]})]})}),(0,B.jsx)(W.N,{children:r&&(0,B.jsx)(P.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full left-0 right-0 mt-2 bg-white border rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",children:(0,B.jsxs)("div",{className:"p-2",children:[(0,B.jsx)("div",{className:"px-2 py-1 mb-2",children:(0,B.jsxs)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:["Available Agents (",Array.isArray(l)?l.length:0,")"]})}),(0,B.jsx)("div",{className:"space-y-1",children:Array.isArray(l)&&l.length>0?l.map(e=>(0,B.jsx)(ye,{agent:e,isSelected:c?.id===e.id,onSelect:p,onSettingsClick:t?s:void 0},e.id)):(0,B.jsxs)("div",{className:"px-2 py-4 text-center",children:[(0,B.jsx)("p",{className:"text-sm text-gray-500",children:"No agents found"}),(0,B.jsxs)(J,{size:"sm",variant:"ghost",onClick:x,className:"mt-2",children:[(0,B.jsx)(fe.A,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})})]})})})]}):(0,B.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:(0,B.jsx)(O.A,{className:"w-4 h-4 text-gray-600"})}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("p",{className:"text-sm text-gray-600 font-medium",children:"No agents available"}),(0,B.jsx)("p",{className:"text-xs text-gray-500",children:"Check your API configuration"})]}),(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:x,disabled:m,children:(0,B.jsx)(fe.A,{className:d("w-4 h-4",m&&"animate-spin")})})]})})},ve=["What can you help me with?","Explain this document","Summarize key points","Answer my questions"],je=({prompt:e,onClick:t})=>(0,B.jsx)("button",{onClick:()=>t(e),className:"p-3 text-left bg-white border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-sm text-gray-700",children:e}),we=({onPromptClick:e})=>{const{currentAgent:t}=S();return(0,B.jsx)("div",{className:"flex flex-col items-center justify-center h-full px-4 py-8",children:(0,B.jsxs)(P.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[(0,B.jsx)("div",{className:"w-16 h-16 rounded-full bg-brand-100 flex items-center justify-center mb-6 mx-auto",children:(0,B.jsx)(R.A,{className:"w-8 h-8 text-brand-600"})}),(0,B.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:["Welcome to ",t?.project_name||"CustomGPT","!"]}),(0,B.jsx)("p",{className:"text-gray-600 mb-8",children:"I'm here to help answer your questions and assist with your tasks. How can I help you today?"}),(0,B.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 w-full",children:ve.map((t,s)=>(0,B.jsx)(P.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1+.1*s},children:(0,B.jsx)(je,{prompt:t,onClick:e})},s))})]})})},Ne=({className:e})=>{const{messages:t,streamingMessage:s,isStreaming:r,sendMessage:a}=T(),{currentConversation:i}=A(),o=(0,n.useRef)(null),l=i&&t.get(i.id)||[];(0,n.useEffect)(()=>{o.current&&o.current.scrollTo({top:o.current.scrollHeight,behavior:"smooth"})},[l,s]);const c=e=>{};return(0,B.jsxs)("div",{ref:o,className:d("flex-1 overflow-y-auto scroll-smooth","bg-gradient-to-b from-gray-50 to-white",e),children:[0===l.length&&!s&&(0,B.jsx)(we,{onPromptClick:e=>{a(e)}}),l.length>0&&(0,B.jsx)("div",{className:"space-y-0",children:l.map((e,t)=>(0,B.jsx)(ne,{message:e,isLast:t===l.length-1,onCitationClick:c,onFeedback:t=>{e.id}},e.id))}),s&&(0,B.jsx)(ne,{message:s,isStreaming:!0,isLast:!0,onCitationClick:c}),r&&!s&&(0,B.jsx)(ue,{})]})},Ce=({mode:e="standalone",onClose:t,onAgentSettings:s})=>{const{currentAgent:n}=S();return"widget"===e||"floating"===e?(0,B.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-white",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center flex-shrink-0",children:(0,B.jsx)(O.A,{className:"w-5 h-5 text-white"})}),(0,B.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,B.jsx)("h2",{className:"font-semibold text-gray-900 truncate",children:n?.project_name||"CustomGPT Assistant"}),(0,B.jsx)("p",{className:"text-xs text-gray-500",children:n?.is_chat_active?"Online":"Offline"})]})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"w-40",children:(0,B.jsx)(be,{onSettingsClick:s,className:"w-full",showSettings:!1})}),t&&(0,B.jsxs)("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors flex-shrink-0",children:[(0,B.jsx)("span",{className:"sr-only",children:"Close"}),"×"]})]})]}):"standalone"===e?(0,B.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-white",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center",children:(0,B.jsx)(O.A,{className:"w-5 h-5 text-white"})}),(0,B.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"CustomGPT Chat"})]}),(0,B.jsx)("div",{className:"flex-1 max-w-xs ml-4",children:(0,B.jsx)(be,{onSettingsClick:s,className:"w-full"})})]}):null},Se=({mode:e="standalone",className:t,onClose:s,onAgentSettings:n})=>{const{sendMessage:r,isStreaming:a,cancelStreaming:i}=T();return(0,B.jsxs)("div",{className:d("flex flex-col bg-white","standalone"===e&&"h-full","widget"===e&&"h-[600px] w-[400px] rounded-lg shadow-xl border border-gray-200","floating"===e&&"h-[600px] w-[400px] rounded-lg shadow-2xl border border-gray-200",t),children:[(0,B.jsx)(Ce,{mode:e,onClose:s,onAgentSettings:e=>{n?.(e)}}),(0,B.jsx)(Ne,{className:"flex-1"}),(0,B.jsx)(ge,{onSend:async(e,t)=>{try{await r(e,t)}catch(e){}},disabled:a,placeholder:a?"AI is thinking...":"Send a message..."})]})};var Ae=s(3252),Ee=s(348),ke=s(6846),Me=s(9606),Te=s(2923),Pe=s(3458),Re=s(5854);const Oe=({conversation:e,isSelected:t,onSelect:s,onDelete:r,onRename:a})=>{const[i,o]=(0,n.useState)(!1),[l,c]=(0,n.useState)(e.name),[m,h]=(0,n.useState)(!1),u=(0,n.useRef)(null),x=(0,n.useRef)(null);(0,n.useEffect)(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&h(!1)};if(m)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[m]),(0,n.useEffect)(()=>{i&&u.current&&(u.current.focus(),u.current.select())},[i]);const p=()=>{l.trim()&&l.trim()!==e.name&&a(e.id,l.trim()),o(!1),c(e.name)};return(0,B.jsx)("div",{className:d("group relative p-3 rounded-lg cursor-pointer transition-colors","hover:bg-gray-50",t&&"bg-brand-50 hover:bg-brand-100"),onClick:()=>!i&&s(e),children:(0,B.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[i?(0,B.jsx)("input",{ref:u,type:"text",value:l,onChange:e=>c(e.target.value),onBlur:p,onKeyDown:t=>{"Enter"===t.key?p():"Escape"===t.key&&(o(!1),c(e.name))},className:"w-full px-2 py-1 text-sm font-medium text-gray-900 bg-white border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",maxLength:100}):(0,B.jsx)("h3",{className:"font-medium text-gray-900 text-sm truncate",children:e.name}),(0,B.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[(0,B.jsx)(Ae.A,{className:"w-3 h-3"}),(0,B.jsx)("span",{children:g(e.updated_at)}),e.message_count&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("span",{children:"•"}),(0,B.jsxs)("span",{children:[e.message_count," messages"]})]})]})]}),!i&&(0,B.jsxs)("div",{className:"relative",ref:x,children:[(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:e=>{e.stopPropagation(),h(!m)},className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 text-gray-400 hover:text-gray-600",children:(0,B.jsx)(Ee.A,{className:"h-3 w-3"})}),(0,B.jsx)(W.N,{children:m&&(0,B.jsx)(P.P.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},transition:{duration:.1},className:"absolute right-0 top-6 mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,B.jsxs)("div",{className:"py-1",children:[(0,B.jsxs)("button",{onClick:e=>{e.stopPropagation(),o(!0),h(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,B.jsx)(ke.A,{className:"w-3 h-3"}),"Rename"]}),(0,B.jsxs)("button",{onClick:t=>{t.stopPropagation(),r(e.id),h(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,B.jsx)(Me.A,{className:"w-3 h-3"}),"Delete"]})]})})})]})]})})},Le=({className:e,isCollapsed:t=!1,onToggle:s})=>{const[r,i]=(0,n.useState)(""),[o,l]=(0,n.useState)(!1),{conversations:c,currentConversation:m,loading:h,error:g,fetchConversations:u,createConversation:x,selectConversation:p,deleteConversation:f}=A(),{currentAgent:y}=S(),{clearMessages:b}=T();(0,n.useEffect)(()=>{y&&u(y.id)},[y,u]);const v=c.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),j=e=>{p(e),b()},w=async e=>{try{await f(e),a.oR.success("Conversation deleted")}catch(e){a.oR.error("Failed to delete conversation")}},N=(e,t)=>{a.oR.success("Conversation renamed")};return t?(0,B.jsx)("div",{className:d("w-12 bg-gray-50 border-r border-gray-200 flex flex-col",e),children:(0,B.jsx)("div",{className:"p-2",children:(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:s,className:"w-8 h-8",title:"Expand sidebar",children:(0,B.jsx)(Te.A,{className:"h-4 w-4"})})})}):(0,B.jsxs)("div",{className:d("w-80 bg-gray-50 border-r border-gray-200 flex flex-col",e),children:[(0,B.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-white",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,B.jsx)("h2",{className:"font-semibold text-gray-900",children:"Conversations"}),(0,B.jsx)(J,{size:"icon",variant:"ghost",onClick:s,className:"h-8 w-8",title:"Collapse sidebar",children:(0,B.jsx)(ie.A,{className:"h-4 w-4"})})]}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)(Pe.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,B.jsx)("input",{type:"text",placeholder:"Search conversations...",value:r,onChange:e=>i(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent"})]})]}),(0,B.jsx)("div",{className:"p-4",children:(0,B.jsxs)(J,{onClick:async()=>{if(y&&!o){l(!0);try{const e=`New Chat ${(new Date).toLocaleDateString()}`;await x(y.id,e),b(),a.oR.success("New conversation created")}catch(e){a.oR.error("Failed to create new conversation")}finally{l(!1)}}},disabled:!y||o,className:"w-full justify-start gap-2",variant:"outline",children:[(0,B.jsx)(Re.A,{className:"w-4 h-4"}),o?"Creating...":"New Chat"]})}),(0,B.jsx)("div",{className:"flex-1 overflow-y-auto",children:h&&0===c.length?(0,B.jsx)("div",{className:"p-4 space-y-3",children:[...Array(3)].map((e,t)=>(0,B.jsxs)("div",{className:"animate-pulse",children:[(0,B.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,B.jsx)("div",{className:"h-3 bg-gray-100 rounded w-3/4"})]},t))}):g&&0===c.length?(0,B.jsxs)("div",{className:"p-4 text-center",children:[(0,B.jsx)("p",{className:"text-sm text-red-600 mb-2",children:"Failed to load conversations"}),(0,B.jsx)(J,{size:"sm",variant:"ghost",onClick:()=>y&&u(y.id),children:"Try Again"})]}):0===v.length?(0,B.jsxs)("div",{className:"p-4 text-center",children:[(0,B.jsx)(Te.A,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,B.jsx)("p",{className:"text-sm text-gray-500",children:r?"No conversations found":"No conversations yet"}),!r&&(0,B.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Start a new conversation to get going"})]}):(0,B.jsx)("div",{className:"p-2 space-y-1",children:v.map(e=>(0,B.jsx)(Oe,{conversation:e,isSelected:m?.id===e.id,onSelect:j,onDelete:w,onRename:N},e.id))})}),(0,B.jsx)("div",{className:"p-4 border-t border-gray-200 bg-white",children:(0,B.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[v.length," conversation",1!==v.length?"s":"",y&&(0,B.jsxs)("span",{className:"block mt-1",children:["Agent: ",y.project_name]})]})})]})},ze=({mode:e="standalone",className:t,onClose:s,onAgentSettings:r,showSidebar:a=!0})=>{const[i,o]=(0,n.useState)(!1),{currentConversation:l}=A(),{loadMessages:c}=T();(0,n.useEffect)(()=>{l&&c(l.id)},[l,c]);return a&&"standalone"===e?(0,B.jsxs)("div",{className:"flex h-full bg-white",children:[(0,B.jsx)(Le,{isCollapsed:i,onToggle:()=>{o(!i)}}),(0,B.jsx)("div",{className:"flex-1 flex flex-col min-w-0",children:(0,B.jsx)(Se,{mode:e,className:"h-full",onClose:s,onAgentSettings:r})})]}):(0,B.jsx)(Se,{mode:e,className:t,onClose:s,onAgentSettings:r})};function _e(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Fe{constructor(e){_e(this,"container",null),_e(this,"root",null),_e(this,"config",void 0),_e(this,"isOpen",!1),this.config={mode:"embedded",theme:"light",position:"bottom-right",width:"400px",height:"600px",enableCitations:!0,enableFeedback:!0,...e},this.init()}init(){C.getState().setApiKey(this.config.apiKey),this.createContainer(),this.render()}createContainer(){const{mode:e,containerId:t}=this.config;if("embedded"===e&&t){if(this.container=document.getElementById(t),!this.container)throw new Error(`Container with id "${t}" not found`)}else"floating"===e?(this.container=document.createElement("div"),this.container.id="customgpt-floating-widget",this.setupFloatingStyles(),document.body.appendChild(this.container)):(this.container=document.createElement("div"),this.container.id="customgpt-widget",document.body.appendChild(this.container))}setupFloatingStyles(){if(!this.container||"floating"!==this.config.mode)return;const{position:e,width:t,height:s}=this.config;switch(Object.assign(this.container.style,{position:"fixed",zIndex:"9999",width:t||"400px",height:s||"600px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",borderRadius:"12px",overflow:"hidden",transition:"all 0.3s ease"}),e){case"bottom-right":Object.assign(this.container.style,{bottom:"20px",right:"20px"});break;case"bottom-left":Object.assign(this.container.style,{bottom:"20px",left:"20px"});break;case"top-right":Object.assign(this.container.style,{top:"20px",right:"20px"});break;case"top-left":Object.assign(this.container.style,{top:"20px",left:"20px"})}this.container.style.display="none"}render(){if(!this.container)return;this.root=(0,r.H)(this.container);const e=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(ze,{mode:"embedded"===this.config.mode?"widget":"floating",onClose:"floating"===this.config.mode?()=>{this.close(),this.config.onClose?.()}:void 0,showSidebar:!1}),(0,B.jsx)(a.l$,{position:"top-center",toastOptions:{style:{zIndex:1e4}}})]});this.root.render((0,B.jsx)(e,{})),"embedded"===this.config.mode&&this.open()}open(){this.container&&(this.isOpen=!0,"floating"===this.config.mode&&(this.container.style.display="block",setTimeout(()=>{this.container&&(this.container.style.transform="translateY(0)",this.container.style.opacity="1")},10)),this.config.onOpen?.())}close(){this.container&&(this.isOpen=!1,"floating"===this.config.mode&&(this.container.style.transform="translateY(20px)",this.container.style.opacity="0",setTimeout(()=>{this.container&&(this.container.style.display="none")},300)))}toggle(){this.isOpen?this.close():this.open()}destroy(){this.root&&this.root.unmount(),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.root=null}updateConfig(e){this.config={...this.config,...e},this.render()}get isOpened(){return this.isOpen}get configuration(){return{...this.config}}}const $e={init:e=>new Fe(e),create:e=>new Fe(e)};"undefined"!=typeof window&&(window.CustomGPTWidget=$e);const De=$e}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var a=s[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,s,r,a)=>{if(!s){var i=1/0;for(d=0;d<e.length;d++){for(var[s,r,a]=e[d],o=!0,l=0;l<s.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every(e=>n.O[e](s[l]))?s.splice(l--,1):(o=!1,a<i&&(i=a));if(o){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,r,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={30:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var r,a,[i,o,l]=s,c=0;if(i.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)var d=l(n)}for(t&&t(s);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},s=this.webpackChunkCustomGPTWidget=this.webpackChunkCustomGPTWidget||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=n.O(void 0,[96],()=>n(9909));return r=n.O(r)})());
//# sourceMappingURL=customgpt-widget.693e3bf38838c2a441a1.js.map