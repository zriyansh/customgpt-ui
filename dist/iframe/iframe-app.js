(()=>{"use strict";var e,t={4085:(e,t,s)=>{var a=s(758),r=s(9576),n=s(1681),i=s(1446),o=s(5189),c=s(3526),l=s(4799);s(8404);function d(...e){return(0,l.QP)((0,c.$)(e))}function g(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function u(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}function m(e){const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/6e4),r=Math.floor(s/36e5),n=Math.floor(s/864e5);return a<1?"Just now":a<60?`${a}m ago`:r<24?`${r}h ago`:n<7?`${n}d ago`:t.toLocaleDateString()}async function h(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return!1}}function p(e){try{if(e.startsWith("event: ")){return"finish"===e.slice(7).trim()?{type:"done"}:null}if(e.startsWith("data: ")){const t=e.slice(6).trim();if("[DONE]"===t||"DONE"===t)return{type:"done"};try{const e=JSON.parse(t);if("object"==typeof e){if(e.type)return e;if(void 0!==e.content)return{type:"content",content:e.content,citations:e.citations};if(e.citations&&!e.content)return{type:"citation",citations:e.citations};if(void 0!==e.message)return{type:"content",content:e.message,citations:e.citations};if(e.delta&&void 0!==e.delta.content)return{type:"content",content:e.delta.content,citations:e.citations};if(e.choices&&e.choices[0]&&e.choices[0].delta){const t=e.choices[0].delta;if(void 0!==t.content)return{type:"content",content:t.content,citations:e.citations}}}return e}catch(e){return{type:"content",content:t}}}if(e.trim().startsWith("{"))try{const t=JSON.parse(e.trim());return void 0!==t.content||void 0!==t.citations?{type:t.content?"content":"citation",content:t.content,citations:t.citations}:void 0!==t.message?{type:"content",content:t.message,citations:t.citations}:t}catch(e){}return!e.trim()||e.includes("data:")||e.startsWith("{")?null:{type:"content",content:e.trim()}}catch(e){return null}}function y(e){return new Promise(t=>setTimeout(t,e))}const f={MAX_FILE_SIZE:10485760,ACCEPTED_FILE_TYPES:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","text/csv","application/json","application/xml","image/jpeg","image/png","image/gif","image/webp"],MAX_MESSAGE_LENGTH:4e3,API_TIMEOUT:3e4,STREAM_TIMEOUT:6e4,RETRY_ATTEMPTS:3,RETRY_DELAY:1e3};function x(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class v{constructor(){x(this,"isClient",void 0),x(this,"logs",[]),this.isClient="undefined"!=typeof window}static getInstance(){return v.instance||(v.instance=new v),v.instance}formatMessage(e){const{timestamp:t,level:s,category:a,message:r,data:n,error:i,stack:o}=e;let c=`[${t}] [${s.toUpperCase()}] [${a}] ${r}`;return n&&(c+=`\nData: ${JSON.stringify(n,null,2)}`),i&&(c+=`\nError: ${i.message||i}`,o&&(c+=`\nStack: ${o}`)),c}writeToFile(e){}log(e,t,s,a,r){const n={timestamp:(new Date).toISOString(),level:e,category:t,message:s,data:a,error:r?{message:r.message,code:r.code,status:r.status}:void 0,stack:r?.stack};this.logs.push(n),this.logs.length>1e3&&(this.logs=this.logs.slice(-500));n.timestamp.split("T")[1].split(".")[0];if(this.isClient);else{}"debug"===e&&this.isClient||this.sendToServer(n)}async sendToServer(e){try{await fetch("/api/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){}}debug(e,t,s){this.log("debug",e,t,s)}info(e,t,s){this.log("info",e,t,s)}warn(e,t,s){this.log("warn",e,t,s)}error(e,t,s,a){this.log("error",e,t,a,s)}getLogs(){return this.logs}clearLogs(){this.logs=[]}apiRequest(e,t,s){this.info("API_REQUEST",`${t} ${e}`,s)}apiResponse(e,t,s){const a=t>=400?"error":"info";this.log(a,"API_RESPONSE",`${e} - Status: ${t}`,s)}apiError(e,t){this.error("API_ERROR",`Failed request to ${e}`,t)}authCheck(e,t){this.info("AUTH",e,t)}authError(e,t){this.error("AUTH_ERROR",e,t)}navigation(e,t){this.info("NAVIGATION",`Navigating to ${e}`,t)}storeAction(e,t,s){this.debug("STORE",`${e}.${t}`,s)}}x(v,"instance",void 0);const b=v.getInstance();function w(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class j{constructor(e){w(this,"baseURL",void 0),w(this,"apiKey",void 0),w(this,"timeout",void 0),w(this,"retryAttempts",void 0),w(this,"retryDelay",void 0),w(this,"abortControllers",new Map),this.apiKey=e.apiKey,this.baseURL=e.baseURL||"https://app.customgpt.ai/api/v1",this.timeout=e.timeout||3e4,this.retryAttempts=e.retryAttempts||3,this.retryDelay=e.retryDelay||1e3,b.info("API_CLIENT","CustomGPT API Client initialized",{baseURL:this.baseURL,timeout:this.timeout,hasApiKey:!!this.apiKey,apiKeyPreview:this.apiKey?`${this.apiKey.substring(0,10)}...`:"none"})}async request(e,t={}){const{timeout:s=this.timeout,retryAttempts:a=this.retryAttempts,params:r,...n}=t,i=new URL(`${this.baseURL}${e}`);r&&Object.entries(r).forEach(([e,t])=>{null!=t&&i.searchParams.append(e,t.toString())});const o={Authorization:`Bearer ${this.apiKey}`,Accept:"application/json",...n.headers};n.body instanceof FormData||(o["Content-Type"]="application/json");const c={...n,headers:o};return b.apiRequest(e,n.method||"GET",{url:i.toString(),headers:{...o,Authorization:`Bearer ${this.apiKey.substring(0,10)}...`},body:n.body?"string"==typeof n.body?JSON.parse(n.body):"FormData":void 0}),async function(e,t=3,s=1e3){let a;for(let r=1;r<=t;r++)try{return await e()}catch(e){if(a=e,r===t)throw a;const n=s*Math.pow(2,r-1);await y(n)}throw a}(async()=>{const t=new AbortController,a=this.generateRequestId();this.abortControllers.set(a,t);const r=setTimeout(()=>{t.abort()},s);try{const s=await fetch(i.toString(),{...c,signal:t.signal});if(clearTimeout(r),this.abortControllers.delete(a),!s.ok){const t=await s.text();let a,r;try{const e=JSON.parse(t);e.data&&e.data.code&&e.data.message?(a=e.data.message,r=e.data.code.toString()):(a=e.message||e.error||"Unknown error",r=e.code?.toString())}catch{a=t||`HTTP ${s.status}`}const n=this.getEnhancedErrorMessage(s.status,a,r);throw b.apiError(e,{status:s.status,message:n,originalMessage:a,errorCode:r,headers:Object.fromEntries(s.headers.entries())}),new S(s.status,n,r)}const n=await s.json();return b.apiResponse(e,s.status,{headers:Object.fromEntries(s.headers.entries()),dataPreview:JSON.stringify(n).substring(0,200)+"..."}),n}catch(e){if(clearTimeout(r),this.abortControllers.delete(a),e instanceof S)throw e;if(e instanceof Error&&"AbortError"===e.name)throw new S(408,"Request timeout");throw new S(0,e instanceof Error?e.message:"Network error")}},a,this.retryDelay)}async streamRequest(e,t={},s={}){const{timeout:a=6e4,params:r,...n}=t,{onChunk:i,onComplete:o,onError:c}=s;b.info("API_CLIENT","Starting stream request",{endpoint:e,method:t.method||"GET",hasBody:!!n.body,bodyContent:n.body?"string"==typeof n.body?JSON.parse(n.body):"FormData":void 0});const l=new URL(`${this.baseURL}${e}`);l.searchParams.append("stream","1"),l.searchParams.append("lang","en"),r&&Object.entries(r).forEach(([e,t])=>{null!=t&&l.searchParams.append(e,t.toString())});const d=new AbortController,g=this.generateRequestId();this.abortControllers.set(g,d);const u=setTimeout(()=>{d.abort()},a);try{b.apiRequest(e,n.method||"POST",{url:l.toString(),headers:{Authorization:`Bearer ${this.apiKey.substring(0,10)}...`,"Content-Type":"application/json",Accept:"text/event-stream"},body:n.body?JSON.parse(n.body):void 0});const t=await fetch(l.toString(),{...n,headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json",Accept:"text/event-stream",...n.headers},signal:d.signal});if(!t.ok){const s=await t.text();let a,r;try{const e=JSON.parse(s);e.data&&e.data.code&&e.data.message?(a=e.data.message,r=e.data.code.toString()):(a=e.message||e.error||"Unknown error",r=e.code?.toString())}catch{a=s||`HTTP ${t.status}`}const n=this.getEnhancedErrorMessage(t.status,a,r);throw b.apiError(e,{status:t.status,message:n,originalMessage:a,errorCode:r,headers:Object.fromEntries(t.headers.entries())}),new S(t.status,n,r)}b.apiResponse(e,t.status,{headers:Object.fromEntries(t.headers.entries()),contentType:t.headers.get("content-type"),isEventStream:t.headers.get("content-type")?.includes("text/event-stream")});const s=t.body?.getReader();if(!s)throw new S(500,"No response body");const a=new TextDecoder;let r="";try{let e=!1;for(;;){const{done:t,value:n}=await s.read();if(t){if(b.info("STREAM","Stream ended",{hasReceivedData:e}),!e)return b.warn("STREAM","Stream ended without receiving any data - possible API issue"),void c?.(new Error("No data received from stream - the API may not support streaming or there was a connection issue"));o?.();break}r+=a.decode(n,{stream:!0});const l=r.split("\n");r=l.pop()||"";for(const t of l)if(t.trim()){e=!0,b.debug("STREAM","Raw SSE line received",{line:t.substring(0,200),fullLine:t,lineLength:t.length});const s=p(t);if(s){if(b.debug("STREAM","Successfully parsed chunk",{type:s.type,hasContent:!!s.content,contentPreview:s.content?.substring(0,100),hasCitations:!!s.citations}),"done"===s.type)return b.info("STREAM","Stream completed with done signal"),void o?.();if("error"===s.type)return b.error("STREAM","Stream error received",{error:s.error}),void c?.(new Error(s.error||"Stream error"));i?.(s)}else b.warn("STREAM","Failed to parse chunk or chunk was null",{originalLine:t.substring(0,200)})}}}finally{s.releaseLock()}}catch(e){e instanceof S?c?.(e):e instanceof Error&&"AbortError"===e.name?c?.(new S(408,"Request timeout")):c?.(new S(0,e instanceof Error?e.message:"Network error"))}finally{clearTimeout(u),this.abortControllers.delete(g)}}cancelRequest(e){const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))}cancelAllRequests(){this.abortControllers.forEach(e=>e.abort()),this.abortControllers.clear()}generateRequestId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}getEnhancedErrorMessage(e,t,s){switch(e){case 400:return t.includes("Agent id must be integer")?"Invalid agent ID provided. Please ensure you have selected a valid agent.":t.includes("Agent name can't be empty")?"Agent name cannot be empty. Please provide a valid agent name.":"Invalid request data. Please check your input and try again.";case 401:return t.includes("API Token is either missing or invalid")?"Authentication failed. Your API key is missing or invalid. Please check your API key in settings and ensure it has proper permissions.":"Authentication failed. Please check your API key and try again.";case 403:return t.includes("license")?"You do not have permission to manage licenses for this agent. Please ensure your API key has the necessary permissions or you are the owner of this agent.":t.includes("Licenses are not allowed")?"License management is not enabled for this agent. Please enable licenses in the agent settings first.":"Access denied. You do not have permission to perform this action. Please check your API key permissions.";case 404:return t.includes("Agent with id")?"The selected agent was not found or you don't have access to it. Please select a different agent or check your permissions.":t.includes("Agent license with id")?"The specified license was not found. It may have been deleted or you may not have access to it.":t.includes("Conversation message with id")||t.includes("not found")?"The requested conversation or message was not found. It may have been deleted or you may not have access to it.":"The requested resource was not found. Please check if it exists and you have access to it.";case 429:return t.includes("exhausted your current query credits")?"You have reached your query limit. Please upgrade your plan or contact customer support at https://customgpt.freshdesk.com/support/home for assistance.":"Rate limit exceeded. Please wait a moment and try again, or contact support if you need higher limits.";case 500:return t.includes("Internal Server Error")?"Server error occurred. Please try again in a few moments. If the problem persists, contact customer support.":"An unexpected server error occurred. Please try again later.";case 501:return t.includes("audio is not yet supported")?"Audio files are not currently supported. Please remove any audio files from your request and try again with text or other supported file types.":"This feature is not yet implemented. Please try a different approach.";case 408:return"Request timed out. Please check your internet connection and try again.";case 422:return t.includes("Agent id must be integer")?"Invalid agent ID format. Please ensure the agent ID is a valid number.":"Invalid data provided. Please check your input and ensure all required fields are correctly formatted.";default:return e>=500?`Server error (${e}): ${t}. Please try again later.`:e>=400?`Request error (${e}): ${t}. Please check your input and try again.`:t}}async getAgents(e){return this.request("/projects",{params:e})}async createAgent(e){const t=new FormData;return t.append("project_name",e.project_name),e.sitemap_path&&t.append("sitemap_path",e.sitemap_path),e.files&&e.files.length>0&&e.files.forEach((e,s)=>{t.append(`files[${s}]`,e)}),void 0!==e.is_shared&&t.append("is_shared",e.is_shared.toString()),this.request("/projects",{method:"POST",body:t})}async getAgent(e){return this.request(`/projects/${e}`)}async updateAgent(e,t){const s=new FormData;return void 0!==t.are_licenses_allowed&&s.append("are_licenses_allowed",t.are_licenses_allowed.toString()),this.request(`/projects/${e}`,{method:"POST",body:s})}async deleteAgent(e){return this.request(`/projects/${e}`,{method:"DELETE"})}async replicateAgent(e){return this.request(`/projects/${e}/replicate`,{method:"POST"})}async getAgentStats(e){return this.request(`/projects/${e}/stats`)}async getAgentSettings(e){return this.request(`/projects/${e}/settings`)}async updateAgentSettings(e,t){const s=t instanceof FormData;return this.request(`/projects/${e}/settings`,{method:"POST",body:s?t:JSON.stringify(t)})}async getConversations(e,t){const s={...t,userFilter:t?.userFilter||"all"};return this.request(`/projects/${e}/conversations`,{params:s})}async createConversation(e,t){return this.request(`/projects/${e}/conversations`,{method:"POST",body:t?JSON.stringify(t):JSON.stringify({})})}async updateConversation(e,t,s){return this.request(`/projects/${e}/conversations/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteConversation(e,t){return this.request(`/projects/${e}/conversations/${t}`,{method:"DELETE"})}async getMessages(e,t,s){const a={...s,stream:!1,lang:"en"};return this.request(`/projects/${e}/conversations/${t}/messages`,{params:a})}async sendMessage(e,t,s){const a={prompt:s.prompt,response_source:s.response_source||"default",custom_persona:s.custom_persona,chatbot_model:s.chatbot_model,stream:0};return Object.keys(a).forEach(e=>{void 0===a[e]&&delete a[e]}),this.request(`/projects/${e}/conversations/${t}/messages`,{method:"POST",body:JSON.stringify(a),params:{stream:!1,lang:"en"}})}async sendMessageStream(e,t,s,a){const r={prompt:s.prompt,response_source:s.response_source||"default",custom_persona:s.custom_persona,chatbot_model:s.chatbot_model,stream:1};return Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]}),b.info("API_CLIENT","Sending streaming message",{projectId:e,sessionId:t,prompt:s.prompt.substring(0,50),hasCustomPersona:!!s.custom_persona,responseSource:r.response_source,streamParam:r.stream}),this.streamRequest(`/projects/${e}/conversations/${t}/messages`,{method:"POST",body:JSON.stringify(r),params:{stream:1,lang:"en"}},a)}async getMessageById(e,t,s){return this.request(`/projects/${e}/conversations/${t}/messages/${s}`)}async updateMessageFeedback(e,t,s,a){return this.request(`/projects/${e}/conversations/${t}/messages/${s}/feedback`,{method:"PUT",body:JSON.stringify(a)})}async sendMessageOpenAIFormat(e,t){return this.request(`/projects/${e}/chat/completions`,{method:"POST",body:JSON.stringify({...t,stream:t.stream??!1,lang:t.lang||"en",is_inline_citation:t.is_inline_citation??!1})})}async getCitation(e,t){return this.request(`/projects/${e}/citations/${t}`)}async uploadFile(e,t,s){const a=new FormData;return a.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{void 0!==t&&a.append(e,t.toString())}),this.request(`/projects/${e}/sources`,{method:"POST",body:a})}async getConversationAnalytics(e,t){const s=new URLSearchParams;return t?.start_date&&s.append("start_date",t.start_date),t?.end_date&&s.append("end_date",t.end_date),t?.limit&&s.append("limit",t.limit.toString()),this.request(`/projects/${e}/analytics/conversations${s.toString()?`?${s}`:""}`)}async getQueryAnalytics(e,t){const s=new URLSearchParams;return t?.start_date&&s.append("start_date",t.start_date),t?.end_date&&s.append("end_date",t.end_date),t?.limit&&s.append("limit",t.limit.toString()),this.request(`/projects/${e}/analytics/queries${s.toString()?`?${s}`:""}`)}async getTrafficAnalytics(e,t){const s=new URLSearchParams;return t?.start_date&&s.append("start_date",t.start_date),t?.end_date&&s.append("end_date",t.end_date),t?.period&&s.append("period",t.period),this.request(`/projects/${e}/analytics/traffic${s.toString()?`?${s}`:""}`)}async getStatistics(e){return this.request(`/projects/${e}/analytics/statistics`)}async getTrafficReport(e){return this.request(`/projects/${e}/reports/traffic`,{method:"GET"})}async getQueriesReport(e){return this.request(`/projects/${e}/reports/queries`,{method:"GET"})}async getConversationsReport(e){return this.request(`/projects/${e}/reports/conversations`,{method:"GET"})}async getAnalysisReport(e,t){const s=new URLSearchParams;return t&&s.append("interval",t),this.request(`/projects/${e}/reports/analysis${s.toString()?`?${s}`:""}`,{method:"GET"})}async getPages(e,t){const s=new URLSearchParams;return t?.page&&s.append("page",t.page.toString()),t?.limit&&s.append("limit",t.limit.toString()),t?.order&&s.append("order",t.order),t?.crawl_status&&s.append("crawl_status",t.crawl_status),t?.index_status&&s.append("index_status",t.index_status),this.request(`/projects/${e}/pages${s.toString()?`?${s}`:""}`)}async deletePage(e,t){return this.request(`/projects/${e}/pages/${t}`,{method:"DELETE"})}async reindexPage(e,t){return this.request(`/projects/${e}/pages/${t}/reindex`,{method:"POST"})}async getPageMetadata(e,t){return this.request(`/projects/${e}/pages/${t}/metadata`,{method:"GET"})}async updatePageMetadata(e,t,s){return this.request(`/projects/${e}/pages/${t}/metadata`,{method:"PUT",body:JSON.stringify(s)})}async previewFile(e){return this.request(`/preview/${e}`)}async getLicenses(e){return this.request(`/projects/${e}/licenses`)}async createLicense(e,t){return this.request(`/projects/${e}/licenses`,{method:"POST",body:JSON.stringify(t)})}async getLicense(e,t){return this.request(`/projects/${e}/licenses/${t}`)}async updateLicense(e,t,s){return this.request(`/projects/${e}/licenses/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteLicense(e,t){return this.request(`/projects/${e}/licenses/${t}`,{method:"DELETE"})}async getSources(e){return this.request(`/projects/${e}/sources`)}async createSitemapSource(e,t){return this.request(`/projects/${e}/sources`,{method:"POST",body:JSON.stringify(t)})}async uploadFileSource(e,t){return this.request(`/projects/${e}/sources`,{method:"POST",body:t})}async updateSourceSettings(e,t,s){return this.request(`/projects/${e}/sources/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteSource(e,t){return this.request(`/projects/${e}/sources/${t}`,{method:"DELETE"})}async instantSyncSource(e,t){return this.request(`/projects/${e}/sources/${t}/instant-sync`,{method:"PUT"})}async getUserLimits(){return this.request("/limits/usage")}async getUserProfile(){return this.request("/user")}async updateUserProfile(e){return this.request("/user",{method:"POST",body:e})}async get(e){return this.request(e)}async post(e,t){return this.request(e,{method:"POST",body:t instanceof FormData?t:t?JSON.stringify(t):void 0})}async put(e,t){return this.request(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}}class S extends Error{constructor(e,t,s,a){super(t),this.status=e,this.code=s,this.details=a,this.name="APIError"}}let N=null;function A(){if(!N)throw new Error("API client not initialized. Call initializeClient() first.");return N}function E(e){return N=new j(e),N}function C(){return null!==N}const _=(0,i.vt)()((0,o.Zr)((e,t)=>({apiKey:null,baseURL:"https://app.customgpt.ai/api/v1",theme:"light",setApiKey:s=>{e({apiKey:s}),s&&E({apiKey:s,baseURL:t().baseURL})},setBaseURL:s=>{e({baseURL:s});const{apiKey:a}=t();a&&E({apiKey:a,baseURL:s})},setTheme:t=>{e({theme:t}),"undefined"!=typeof window&&(document.documentElement.className=t)}}),{name:"customgpt-config",partialize:e=>({apiKey:e.apiKey,baseURL:e.baseURL,theme:e.theme}),onRehydrateStorage:()=>e=>{e?.apiKey&&!C()&&E({apiKey:e.apiKey,baseURL:e.baseURL}),e?.theme&&"undefined"!=typeof window&&(document.documentElement.className=e.theme)}})),I=(0,i.vt)()((0,o.Zr)((e,t)=>({agents:[],currentAgent:null,loading:!1,error:null,fetchAgents:async()=>{e({loading:!0,error:null});try{const s=A(),a=await s.getAgents();let r=[];a&&"object"==typeof a&&(Array.isArray(a.data)?r=a.data:Array.isArray(a)?r=a:a.data&&Array.isArray(a.data.data)&&(r=a.data.data)),e({agents:r,loading:!1,currentAgent:t().currentAgent||(r.length>0?r[0]:null)})}catch(t){e({agents:[],error:t instanceof Error?t.message:"Failed to fetch agents",loading:!1})}},createAgent:async t=>{e({loading:!0,error:null});try{const s=A(),a=(await s.createAgent(t)).data;return e(e=>({agents:[a,...e.agents],currentAgent:a,loading:!1})),a}catch(t){throw e({error:t instanceof Error?t.message:"Failed to create agent",loading:!1}),t}},selectAgent:t=>{e({currentAgent:t})},setAgents:s=>{e({agents:s,currentAgent:(()=>{const e=t().currentAgent;if(!e)return s.length>0?s[0]:null;return s.find(t=>t.id===e.id)||(s.length>0?s[0]:null)})()})},updateAgent:async(t,s)=>{e({loading:!0,error:null});try{const a=A(),r=(await a.updateAgent(t,s)).data;return e(e=>({agents:e.agents.map(e=>e.id===t?r:e),currentAgent:e.currentAgent?.id===t?r:e.currentAgent,loading:!1})),r}catch(t){throw e({error:t instanceof Error?t.message:"Failed to update agent",loading:!1}),t}},deleteAgent:async t=>{e({loading:!0,error:null});try{const s=A();await s.deleteAgent(t),e(e=>{const s=e.agents.filter(e=>e.id!==t);return{agents:s,currentAgent:e.currentAgent?.id===t?s.length>0?s[0]:null:e.currentAgent,loading:!1}})}catch(t){throw e({error:t instanceof Error?t.message:"Failed to delete agent",loading:!1}),t}},replicateAgent:async t=>{e({loading:!0,error:null});try{const s=A(),a=(await s.replicateAgent(t)).data;return e(e=>({agents:[a,...e.agents],currentAgent:a,loading:!1})),a}catch(t){throw e({error:t instanceof Error?t.message:"Failed to replicate agent",loading:!1}),t}},getAgentStats:async e=>{try{const t=A();return(await t.getAgentStats(e)).data}catch(e){throw e}}}),{name:"customgpt-agents",partialize:e=>({currentAgent:e.currentAgent})})),P=(0,i.vt)()((0,o.Zr)((e,t)=>({conversations:[],currentConversation:null,loading:!1,error:null,fetchConversations:async t=>{b.info("CONVERSATIONS","Fetching conversations",{projectId:t}),e({loading:!0,error:null});try{const s=A(),a=await s.getConversations(t);b.info("CONVERSATIONS","API response received",{projectId:t,responseType:typeof a,hasData:!!a?.data,dataLength:Array.isArray(a?.data)?a.data.length:0});let r=[];a&&"object"==typeof a&&(Array.isArray(a.data)?r=a.data:Array.isArray(a)?r=a:a.data&&Array.isArray(a.data.data)&&(r=a.data.data)),b.info("CONVERSATIONS","Processed conversations",{count:r.length,conversations:r.map(e=>({id:e.id,name:e.name,messagesCount:e.messages?.length||0}))}),e({conversations:r,loading:!1})}catch(s){b.error("CONVERSATIONS","Failed to fetch conversations",s,{projectId:t,errorType:s instanceof Error?s.constructor.name:typeof s,status:s?.status,message:s?.message}),e({error:s instanceof Error?s.message:"Failed to fetch conversations",loading:!1})}},createConversation:async(t,s)=>{e({loading:!0,error:null});try{const a=A(),r=(await a.createConversation(t,s?{name:s}:void 0)).data;e(e=>({conversations:[r,...e.conversations],currentConversation:r,loading:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"Failed to create conversation",loading:!1}),t}},selectConversation:t=>{e({currentConversation:t})},deleteConversation:async s=>{const{conversations:a,currentConversation:r}=t(),n=a.find(e=>e.id.toString()===s.toString());if(n){e({loading:!0,error:null});try{const t=A();await t.deleteConversation(n.project_id,n.session_id);const i=a.filter(e=>e.id.toString()!==s.toString());e({conversations:i,currentConversation:r?.id.toString()===s.toString()?i.length>0?i[0]:null:r,loading:!1})}catch(t){throw e({error:t instanceof Error?t.message:"Failed to delete conversation",loading:!1}),t}}},updateConversation:async(t,s,a)=>{e({loading:!0,error:null});try{const r=A(),n=(await r.updateConversation(t,s,a)).data;e(e=>({conversations:e.conversations.map(e=>e.id===t?n:e),currentConversation:e.currentConversation?.id===t?n:e.currentConversation,loading:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"Failed to update conversation",loading:!1}),t}},ensureConversation:async(s,a)=>{const{currentConversation:r,conversations:n}=t();if(r&&r.project_id===s)return r;const i=n.filter(e=>e.project_id===s);if(i.length>0){const t=i[0];return e({currentConversation:t}),t}const o=a?function(e){const t=e.trim().split(/\s+/).slice(0,6).join(" ");return t.length>50?t.substring(0,50).trim()+"...":t}(a):`Chat ${(new Date).toLocaleDateString()}`;return await t().createConversation(s,o),t().currentConversation}}),{name:`customgpt-conversations-${(()=>{if("undefined"==typeof window)return"server-session";if(window.__customgpt_session)return window.__customgpt_session.sessionId;try{let e=sessionStorage.getItem("customgpt_session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("customgpt_session_id",e)),e}catch(e){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}})()}`,partialize:e=>({conversations:e.conversations,currentConversation:e.currentConversation}),onRehydrateStorage:()=>e=>{e&&!Array.isArray(e.conversations)&&(e.conversations=[])}}));function k(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class M{constructor(e={}){k(this,"config",void 0),k(this,"abortController",null),k(this,"currentMessage",null),this.config={timeout:e.timeout||6e4,retryAttempts:e.retryAttempts||3,retryDelay:e.retryDelay||1e3}}async processStream(e,t){this.abortController=new AbortController,this.currentMessage={id:this.generateId(),content:"",citations:[],isComplete:!1};const s=e.getReader(),a=new TextDecoder;let r="";const n=setTimeout(()=>{this.cancel(),t.onError?.(new Error("Stream timeout"))},this.config.timeout);try{for(;;){const{done:e,value:n}=await s.read();if(e){this.currentMessage.isComplete=!0,t.onComplete?.();break}r+=a.decode(n,{stream:!0});const i=r.split("\n");r=i.pop()||"";for(const e of i)e.trim()&&await this.processLine(e,t)}}catch(e){e instanceof Error&&"AbortError"===e.name?t.onError?.(new Error("Stream cancelled")):t.onError?.(e instanceof Error?e:new Error("Unknown streaming error"))}finally{clearTimeout(n),s.releaseLock(),this.abortController=null}return this.currentMessage}async processLine(e,t){const s=p(e);if(s&&this.currentMessage)switch(s.type){case"content":s.content&&(this.currentMessage.content+=s.content,t.onChunk?.(s.content));break;case"citation":s.citations&&(this.currentMessage.citations.push(...s.citations),s.citations.forEach(e=>{t.onCitation?.(e)}));break;case"done":return this.currentMessage.isComplete=!0,void t.onComplete?.();case"error":return void t.onError?.(new Error(s.error||"Stream error"))}}cancel(){this.abortController&&this.abortController.abort()}getCurrentMessage(){return this.currentMessage}isStreaming(){return null!==this.abortController&&null!==this.currentMessage&&!this.currentMessage.isComplete}generateId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}}const R=new class{constructor(e=3){k(this,"streams",new Map),k(this,"maxConcurrentStreams",void 0),this.maxConcurrentStreams=e}async startStream(e,t,s,a){if(this.streams.size>=this.maxConcurrentStreams)throw new Error(`Maximum concurrent streams (${this.maxConcurrentStreams}) reached`);this.streams.has(e)&&this.cancelStream(e);const r=new M(a);this.streams.set(e,r);try{return await r.processStream(t,{...s,onComplete:()=>{this.streams.delete(e),s.onComplete?.()},onError:t=>{this.streams.delete(e),s.onError?.(t)}})}catch(t){throw this.streams.delete(e),t}}cancelStream(e){const t=this.streams.get(e);t&&(t.cancel(),this.streams.delete(e))}cancelAllStreams(){this.streams.forEach(e=>e.cancel()),this.streams.clear()}getActiveStreams(){return Array.from(this.streams.keys())}getStreamStatus(e){const t=this.streams.get(e);return t?{exists:!0,isStreaming:t.isStreaming(),message:t.getCurrentMessage()}:{exists:!1,isStreaming:!1,message:null}}getActiveStreamCount(){return this.streams.size}},T="customgpt-messages-cache";function $(e,t){try{const s=localStorage.getItem(T),a=s?JSON.parse(s):{};a[e]=t,localStorage.setItem(T,JSON.stringify(a))}catch(e){}}const L=(0,i.vt)((e,t)=>({messages:new Map,streamingMessage:null,isStreaming:!1,loading:!1,error:null,sendMessage:async(s,a)=>{"undefined"!=typeof window&&window.__customgpt_demo_mode;const r=I.getState(),n=P.getState(),{currentAgent:i}=r;if(!i)throw b.error("MESSAGES","No agent selected when trying to send message"),new Error("No agent selected");b.info("MESSAGES","Sending message",{agentId:i.id,agentName:i.project_name,messageLength:s.length,hasFiles:a&&a.length>0});const o=await n.ensureConversation(i.id,s);if(b.info("MESSAGES","Conversation ensured",{conversationId:o.id,sessionId:o.session_id,hasSessionId:!!o.session_id,isNew:!o.message_count||0===o.message_count}),!o.session_id)throw b.error("MESSAGES","Conversation missing session_id",{conversation:o}),new Error("Conversation missing session_id");e({loading:!0,error:null});const c={id:g(),role:"user",content:s,timestamp:(new Date).toISOString(),status:"sending"};t().addMessage(o.id.toString(),c);const l={id:g(),role:"assistant",content:"",timestamp:(new Date).toISOString(),citations:[]};e({streamingMessage:l,isStreaming:!0,loading:!1});try{if(a&&a.length>0){const e=A();await Promise.all(a.map(t=>e.uploadFile(i.id,t)))}c.status="sent",t().addMessage(o.id.toString(),c);const r=A();b.info("MESSAGES","Starting message stream",{agentId:i.id,sessionId:o.session_id,messageContent:s.substring(0,50)});try{await r.sendMessageStream(i.id,o.session_id,{prompt:s,response_source:"default",stream:1},{onChunk:s=>{if(b.debug("MESSAGES","Received stream chunk",{type:s.type,hasContent:!!s.content,contentLength:s.content?.length,contentPreview:s.content?.substring(0,50)}),"content"===s.type&&s.content)t().updateStreamingMessage(s.content,s.citations);else if("citation"===s.type&&s.citations){const a=t().streamingMessage;a&&e({streamingMessage:{...a,citations:s.citations}})}},onComplete:()=>{const s=t().streamingMessage;s&&(s.status="sent",t().addMessage(o.id.toString(),s)),e({streamingMessage:null,isStreaming:!1})},onError:async a=>{b.error("MESSAGES","Streaming failed, attempting fallback to non-streaming",a,{errorMessage:a.message,agentId:i.id,sessionId:o.session_id});try{b.info("MESSAGES","Using non-streaming fallback");const a=await r.sendMessage(i.id,o.session_id,{prompt:s,response_source:"default",stream:0}),n=t().streamingMessage;if(n&&a){let e;e=a.data?a.data:a,n.content=e?.openai_response||e?.content||"No response received",n.citations=e?.citations||[],n.status="sent",t().addMessage(o.id.toString(),n)}e({streamingMessage:null,isStreaming:!1}),b.info("MESSAGES","Fallback to non-streaming successful")}catch(s){b.error("MESSAGES","Both streaming and non-streaming failed",s);const a=t().streamingMessage;a&&(a.content="Sorry, I encountered an error while processing your message. Please try again.",a.status="error",t().addMessage(o.id.toString(),a)),e({streamingMessage:null,isStreaming:!1,error:`Communication error: ${s instanceof Error?s.message:"Unknown error"}`})}}})}catch(e){throw b.error("MESSAGES","Failed to setup streaming",e),e}}catch(s){throw b.error("MESSAGES","Failed to send message",s,{errorType:s instanceof Error?s.constructor.name:typeof s,errorMessage:s instanceof Error?s.message:String(s),stack:s instanceof Error?s.stack:void 0,agentId:i.id,conversationId:o.id,sessionId:o.session_id}),c.status="error",t().addMessage(o.id.toString(),c),e({streamingMessage:null,isStreaming:!1,error:s instanceof Error?s.message:"Failed to send message",loading:!1}),s}},addMessage:(t,s)=>{e(e=>{const a=new Map(e.messages),r=a.get(t)||[],n=r.findIndex(e=>e.id===s.id);return n>=0?r[n]=s:r.push(s),a.set(t,r),$(t,r),{messages:a}})},updateStreamingMessage:(t,s)=>{e(e=>e.streamingMessage?{streamingMessage:{...e.streamingMessage,content:e.streamingMessage.content+t,citations:s||e.streamingMessage.citations}}:e)},clearMessages:t=>{e(e=>{if(t){const s=new Map(e.messages);return s.delete(t),{messages:s}}return{messages:new Map}})},updateMessageFeedback:async(e,s)=>{const a=I.getState(),r=P.getState(),{currentAgent:n}=a,{currentConversation:i}=r;if(!n||!i)return;const o=(t().messages.get(i.id.toString())||[]).find(t=>t.id===e);if(o)try{const e={...o,feedback:s};t().addMessage(i.id.toString(),e)}catch(e){t().addMessage(i.id.toString(),o)}},getMessagesForConversation:e=>t().messages.get(e)||[],cancelStreaming:()=>{R.cancelAllStreams(),e({streamingMessage:null,isStreaming:!1})},loadMessages:async t=>{if("undefined"!=typeof window&&window.__customgpt_demo_mode)return b.info("MESSAGES","Skipping message load in demo mode",{conversationId:t}),void e(e=>{const s=new Map(e.messages);return s.has(t)||s.set(t,[]),{messages:s,loading:!1}});const s=I.getState(),a=P.getState(),{currentAgent:r}=s,{conversations:n}=a;if(!r)return void b.warn("MESSAGES","No current agent when loading messages",{conversationId:t});const i=n.find(e=>e.id.toString()===t);if(!i)return b.error("MESSAGES","Conversation not found in store",{conversationId:t,availableConversations:n.map(e=>e.id)}),void e(e=>{const s=new Map(e.messages);return s.has(t)||s.set(t,[]),{messages:s,loading:!1}});b.info("MESSAGES","Loading messages for conversation",{conversationId:t,sessionId:i.session_id,agentId:r.id,agentName:r.project_name}),e({loading:!0,error:null});try{const s=A(),a=await s.getMessages(r.id,i.session_id);b.info("MESSAGES","Messages API response received",{conversationId:t,responseType:typeof a,hasData:!!a?.data,dataLength:Array.isArray(a?.data)?a.data.length:0});let n=[];a&&"object"==typeof a&&(a.data&&a.data.messages&&Array.isArray(a.data.messages.data)?n=a.data.messages.data:Array.isArray(a.data)?n=a.data:Array.isArray(a)?n=a:a.data&&Array.isArray(a.data.data)&&(n=a.data.data)),b.info("MESSAGES","Processing messages",{conversationId:t,messagesCount:n.length,messageTypes:n.map(e=>e.role||"unknown")});const o=[];Array.isArray(n)&&n.forEach(e=>{const t=e.created_at||e.timestamp||(new Date).toISOString();e.user_query&&o.push({id:`${e.id}-user`||`user-${Math.random()}`,role:"user",content:e.user_query,timestamp:t,status:"sent"}),e.openai_response&&o.push({id:`${e.id}-assistant`||`assistant-${Math.random()}`,role:"assistant",content:e.openai_response,citations:e.citations||[],timestamp:t,status:"sent",feedback:e.response_feedback?.reaction||e.feedback})}),b.info("MESSAGES","Messages formatted successfully",{conversationId:t,formattedCount:o.length}),e(e=>{const s=new Map(e.messages);return s.set(t,o),$(t,o),{messages:s,loading:!1}})}catch(s){b.error("MESSAGES","Failed to load messages",s,{conversationId:t,agentId:r.id,errorType:s instanceof Error?s.constructor.name:typeof s,status:s?.status,message:s?.message});const a=function(e){try{const t=localStorage.getItem(T);return t&&JSON.parse(t)[e]||null}catch(e){return null}}(t);a&&a.length>0?(b.info("MESSAGES","Using cached messages as fallback",{conversationId:t,messageCount:a.length}),e(e=>{const s=new Map(e.messages);return s.set(t,a),{messages:s,loading:!1,error:"Using cached messages (API unavailable)"}})):e({error:s instanceof Error?s.message:"Failed to load messages",loading:!1})}}})),F=((0,i.vt)()((0,o.Zr)(e=>({sidebarOpen:!0,settingsOpen:!1,theme:"light",fontSize:"md",setSidebarOpen:t=>{e({sidebarOpen:t})},setSettingsOpen:t=>{e({settingsOpen:t})},setTheme:t=>{e({theme:t}),"undefined"!=typeof window&&(document.documentElement.className=t)},setFontSize:t=>{if(e({fontSize:t}),"undefined"!=typeof window){const e=document.documentElement;switch(e.classList.remove("text-sm","text-base","text-lg"),t){case"sm":e.classList.add("text-sm");break;case"lg":e.classList.add("text-lg");break;default:e.classList.add("text-base")}}}}),{name:"customgpt-ui",partialize:e=>({sidebarOpen:e.sidebarOpen,theme:e.theme,fontSize:e.fontSize}),onRehydrateStorage:()=>e=>{if("undefined"!=typeof window&&e){document.documentElement.className=e.theme;const t=document.documentElement;switch(t.classList.remove("text-sm","text-base","text-lg"),e.fontSize){case"sm":t.classList.add("text-sm");break;case"lg":t.classList.add("text-lg");break;default:t.classList.add("text-base")}}}})),e=>e.toISOString().split("T")[0]),O=()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-30),{startDate:F(t),endDate:F(e)}},q=((0,i.vt)((e,t)=>({analytics:null,loading:!1,error:null,dateRange:O(),fetchAnalytics:async s=>{e({loading:!0,error:null});try{const a=A(),{startDate:r,endDate:n}=t().dateRange,[i,o,c,l,d]=await Promise.all([a.getConversationAnalytics(s,{start_date:r,end_date:n}),a.getQueryAnalytics(s,{start_date:r,end_date:n}),a.getTrafficAnalytics(s,{start_date:r,end_date:n,period:"day"}),a.getStatistics(s),a.getAnalysisReport(s,"weekly")]),g={conversations:{total:i.data?.total||0,active:i.data?.active||0,trend:i.data?.trend||0,data:i.data?.timeline||[]},queries:{total:o.data?.total||0,successful:o.data?.successful||0,failed:o.data?.failed||0,avgResponseTime:o.data?.avg_response_time||0,topQueries:o.data?.top_queries||[],data:o.data?.timeline||[]},traffic:{uniqueUsers:c.data?.unique_users||0,pageViews:c.data?.page_views||0,avgSessionDuration:c.data?.avg_session_duration||0,bounceRate:c.data?.bounce_rate||0,data:c.data?.timeline||[]},statistics:{totalMessages:l.data?.total_messages||0,totalConversations:l.data?.total_conversations||0,avgMessagesPerConversation:l.data?.avg_messages_per_conversation||0,satisfactionRate:l.data?.satisfaction_rate||0,responseAccuracy:l.data?.response_accuracy||0}};e({analytics:g,loading:!1})}catch(t){e({analytics:null,error:t instanceof Error?t.message:"Failed to fetch analytics",loading:!1}),n.oR.error("Failed to fetch analytics data")}},setDateRange:(t,s)=>{e({dateRange:{startDate:t,endDate:s}})},exportAnalytics:async e=>{const s=t().analytics;if(s)try{switch(e){case"json":const e=JSON.stringify(s,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`analytics-${(new Date).toISOString()}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),n.oR.success("Analytics exported successfully");break;case"csv":n.oR.info("CSV export not yet implemented");break;case"pdf":n.oR.info("PDF export not yet implemented")}}catch(e){n.oR.error("Failed to export analytics")}else n.oR.error("No analytics data to export")},reset:()=>{e({analytics:null,loading:!1,error:null,dateRange:O()})}})),(0,i.vt)((e,t)=>({pages:[],loading:!1,error:null,paginationInfo:{current_page:1,total:0,per_page:20,last_page:1},queryParams:{page:1,limit:20,order:"desc",crawl_status:"all",index_status:"all"},fetchPages:async s=>{if(C()){e({loading:!0,error:null});try{const a=A(),{queryParams:r}=t(),n=await a.getPages(s,r);e({pages:n.data.pages.data,paginationInfo:{current_page:n.data.pages.current_page,total:n.data.pages.total,per_page:n.data.pages.per_page,last_page:n.data.pages.last_page},loading:!1})}catch(t){let s="Failed to fetch pages";400===t.status?s="Invalid request. Please check the project ID.":401===t.status?s="Authentication failed. Please log in again.":404===t.status?s="Project not found.":500===t.status&&(s="Server error. Please try again later."),e({error:s,loading:!1}),n.oR.error(s)}}else e({error:"API client not initialized"})},deletePage:async(t,s)=>{if(C()){e({loading:!0,error:null});try{const a=A();await a.deletePage(t,s),e(e=>({pages:e.pages.filter(e=>e.id!==s),loading:!1})),n.oR.success("Page deleted successfully")}catch(t){let s="Failed to delete page";401===t.status?s="Authentication failed. Please log in again.":404===t.status&&(s="Page not found."),e({error:s,loading:!1}),n.oR.error(s)}}else n.oR.error("API client not initialized")},reindexPage:async(t,s)=>{if(C()){e({loading:!0,error:null});try{const a=A();await a.reindexPage(t,s),e(e=>({pages:e.pages.map(e=>e.id===s?{...e,crawl_status:"queued",index_status:"queued"}:e),loading:!1})),n.oR.success("Page reindexing started")}catch(t){let s="Failed to reindex page";401===t.status?s="Authentication failed. Please log in again.":403===t.status&&(s="The page could not be reindexed."),e({error:s,loading:!1}),n.oR.error(s)}}else n.oR.error("API client not initialized")},setQueryParams:t=>{e(e=>({queryParams:{...e.queryParams,...t}}))},reset:()=>{e({pages:[],loading:!1,error:null,paginationInfo:{current_page:1,total:0,per_page:20,last_page:1},queryParams:{page:1,limit:20,order:"desc",crawl_status:"all",index_status:"all"}})}})),(0,i.vt)((e,t)=>({sources:[],currentSource:null,loading:!1,error:null,searchQuery:"",filter:{status:"all",type:"all",sortBy:"updated_at",sortOrder:"desc"},syncStatus:{syncing:!1},fetchSources:async t=>{e({loading:!0,error:null});try{A();throw e({sources:[],loading:!1}),new Error("Sources API integration needs update")}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch sources",loading:!1}),n.oR.error("Failed to load sources")}},fetchSource:async(t,s)=>{e({loading:!0,error:null});try{throw new Error("getSource API method not available")}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch source",loading:!1}),n.oR.error("Failed to load source details")}},uploadSources:async(s,a)=>{e({loading:!0,error:null});try{A();const r=a.map(e=>Promise.reject(new Error("uploadFile API method not available")));await Promise.all(r);await t().fetchSources(s),n.oR.success(`Successfully uploaded ${a.length} file(s)`),e({loading:!1})}catch(t){throw e({error:t instanceof Error?t.message:"Failed to upload sources",loading:!1}),n.oR.error("Failed to upload files"),t}},updateSource:async(t,s,a)=>{e({loading:!0,error:null});try{A();throw new Error("updateSource API method not available")}catch(t){throw e({error:t instanceof Error?t.message:"Failed to update source",loading:!1}),n.oR.error("Failed to update source"),t}},deleteSource:async(t,s)=>{e({loading:!0,error:null});try{const a=A();await a.deleteSource(t,parseInt(s)),e(e=>({sources:e.sources.filter(e=>e.id!==s),currentSource:e.currentSource?.id===s?null:e.currentSource,loading:!1})),n.oR.success("Source deleted successfully")}catch(t){throw e({error:t instanceof Error?t.message:"Failed to delete source",loading:!1}),n.oR.error("Failed to delete source"),t}},bulkDelete:async(t,s)=>{e({loading:!0,error:null});try{const a=A();await Promise.all(s.map(e=>a.deleteSource(t,parseInt(e)))),e(e=>({sources:e.sources.filter(e=>!s.includes(e.id)),currentSource:s.includes(e.currentSource?.id||"")?null:e.currentSource,loading:!1})),n.oR.success(`Successfully deleted ${s.length} source(s)`)}catch(t){throw e({error:t instanceof Error?t.message:"Failed to delete sources",loading:!1}),n.oR.error("Failed to delete sources"),t}},syncSources:async t=>{e(e=>({syncStatus:{...e.syncStatus,syncing:!0,progress:0}}));try{A();throw new Error("syncSources API method not available")}catch(t){throw e(e=>({syncStatus:{...e.syncStatus,syncing:!1},error:t instanceof Error?t.message:"Failed to sync sources"})),n.oR.error("Failed to sync sources"),t}},setSearchQuery:t=>{e({searchQuery:t})},setFilter:t=>{e(e=>({filter:{...e.filter,...t}}))},selectSource:t=>{e({currentSource:t})},reset:()=>{e({sources:[],currentSource:null,loading:!1,error:null,searchQuery:"",filter:{status:"all",type:"all",sortBy:"updated_at",sortOrder:"desc"},syncStatus:{syncing:!1}})}})),(0,i.vt)()((0,o.Zr)((e,t)=>({profile:null,loading:!1,error:null,fetchProfile:async()=>{e({loading:!0,error:null});try{const t=A(),s=await t.get("/user");if("success"!==s.status)throw new Error("Failed to fetch profile");e({profile:s.data,loading:!1})}catch(t){e({error:`Failed to fetch profile: ${t instanceof Error?t.message:"Unknown error"}`,loading:!1}),n.oR.error("Failed to load profile")}},updateProfile:async(t,s)=>{e({loading:!0,error:null});try{const a=A(),r=new FormData;r.append("name",t),s&&r.append("profile_photo",s);const i=await a.post("/user",r);if("success"!==i.status)throw new Error("Failed to update profile");e({profile:i.data,loading:!1}),n.oR.success("Profile updated successfully")}catch(t){e({error:`Failed to update profile: ${t instanceof Error?t.message:"Unknown error"}`,loading:!1}),n.oR.error("Failed to update profile")}},reset:()=>{e({profile:null,loading:!1,error:null})}}),{name:"profile-store",partialize:e=>({profile:e.profile})})),new Map);(0,i.vt)((e,t)=>({settings:null,settingsLoading:!1,settingsError:null,plugins:[],pluginsLoading:!1,pluginsError:null,stats:null,statsLoading:!1,statsError:null,fetchSettings:async t=>{const s=`settings-${t}`;if(!q.get(s)){q.set(s,!0),e({settingsLoading:!0,settingsError:null});try{const s=await A().get(`/projects/${t}/settings`);if(200!==s.status)throw new Error("Failed to fetch project settings");e({settings:s.data,settingsLoading:!1,settingsError:null})}catch(t){const s=t instanceof Error?t.message:"Failed to fetch project settings";e({settingsError:s,settingsLoading:!1}),t instanceof Error&&!t.message.includes("404")&&n.oR.error(s)}finally{q.delete(s)}}},updateSettings:async(s,a)=>{e({settingsLoading:!0,settingsError:null});try{const r=new FormData;Object.entries(a).forEach(([e,t])=>{null!=t&&("example_questions"===e&&Array.isArray(t)?t.forEach((e,t)=>{r.append(`example_questions[${t}]`,e)}):t instanceof File?r.append(e,t):r.append(e,String(t)))});const i=await A().post(`/projects/${s}/settings`,r);if(200!==i.status||!i.data.updated)throw new Error("Failed to update project settings");{const s={...t().settings||{},...a};e({settings:s,settingsLoading:!1}),n.oR.success("Project settings updated successfully")}}catch(t){const s=t instanceof Error?t.message:"Failed to update project settings";e({settingsError:s,settingsLoading:!1}),n.oR.error(s)}},fetchPlugins:async t=>{e({pluginsLoading:!0,pluginsError:null});try{const s=await A().get(`/projects/${t}/plugins`);if(200!==s.status)throw new Error("Failed to fetch project plugins");e({plugins:Array.isArray(s.data)?s.data:[],pluginsLoading:!1})}catch(t){const s=t instanceof Error?t.message:"Failed to fetch project plugins";e({pluginsError:s,pluginsLoading:!1,plugins:[]})}},updatePlugin:async(s,a,r)=>{try{if(200!==(await A().put(`/projects/${s}/plugins/${a}`,{enabled:r})).status)throw new Error("Failed to update plugin");{const s=t().plugins.map(e=>e.id===a?{...e,enabled:r}:e);e({plugins:s}),n.oR.success(`Plugin ${r?"enabled":"disabled"} successfully`)}}catch(e){const t=e instanceof Error?e.message:"Failed to update plugin";n.oR.error(t)}},fetchStats:async t=>{e({statsLoading:!0,statsError:null});try{const s=await A().get(`/projects/${t}/stats`);if(200!==s.status)throw new Error("Failed to fetch project stats");e({stats:s.data,statsLoading:!1})}catch(t){const s=t instanceof Error?t.message:"Failed to fetch project stats";e({statsError:s,statsLoading:!1}),n.oR.error(s)}},reset:()=>{e({settings:null,settingsLoading:!1,settingsError:null,plugins:[],pluginsLoading:!1,pluginsError:null,stats:null,statsLoading:!1,statsError:null})}})),(0,i.vt)((e,t)=>({licenses:[],loading:!1,error:null,fetchLicenses:async t=>{e({loading:!0,error:null});try{const s=A(),a=await s.getLicenses(t);b.info("LICENSES","API Response",{projectId:t,status:"success",responseType:typeof a,hasData:!!a?.data,dataType:Array.isArray(a?.data)?"array":typeof a?.data,dataLength:Array.isArray(a?.data)?a.data.length:0,fullResponse:a});const r=Array.isArray(a.data)?a.data:[];b.info("LICENSES","Processed licenses",{count:r.length,licenses:r.map(e=>({name:e.name,key:e.key?.substring(0,8)+"...",project_id:e.project_id}))}),e({licenses:r,loading:!1})}catch(s){b.error("LICENSES","Failed to fetch licenses",{projectId:t,errorType:s?.constructor?.name,errorMessage:s?.message,errorStatus:s?.status,errorCode:s?.code,fullError:s});const a=s instanceof Error?s.message:"Failed to fetch licenses";e({error:a,loading:!1,licenses:[]})}},createLicense:async(t,s)=>{e({loading:!0,error:null}),b.info("LICENSES","Creating license",{projectId:t,name:s});try{const a=A(),r=await a.createLicense(t,{name:s});b.info("LICENSES","Create license API response",{projectId:t,name:s,status:"success",responseType:typeof r,hasData:!!r?.data,dataStructure:r?.data?Object.keys(r.data):[],licenseKey:r.data?.licenseKey?.substring(0,8)+"...",fullResponse:r});const n=r.data?.license||r.data;return n&&(b.info("LICENSES","New license created",{licenseName:n.name,licenseKey:n.key?.substring(0,8)+"...",project_id:n.project_id}),e(e=>({licenses:[...e.licenses,n],loading:!1}))),n}catch(a){b.error("LICENSES","Failed to create license",{projectId:t,name:s,errorType:a?.constructor?.name,errorMessage:a?.message,errorStatus:a?.status,errorCode:a?.code,fullError:a});const r=a instanceof Error?a.message:"Failed to create license";throw e({error:r,loading:!1}),a}},updateLicense:async(t,s,a)=>{e({loading:!0,error:null});try{const r=A(),n=await r.updateLicense(t,s,{name:a});b.info("LICENSES","Updated license",{projectId:t,licenseId:s,name:a});(n.license||n.data)&&e(e=>({licenses:e.licenses.map(e=>e.key===s?{...e,name:a,updated_at:(new Date).toISOString()}:e),loading:!1}))}catch(t){b.error("LICENSES","Failed to update license",t);const s=t instanceof Error?t.message:"Failed to update license";throw e({error:s,loading:!1}),t}},deleteLicense:async(t,s)=>{e({loading:!0,error:null});try{const a=A();await a.deleteLicense(t,s),b.info("LICENSES","Deleted license",{projectId:t,licenseId:s}),e(e=>({licenses:e.licenses.filter(e=>e.key!==s),loading:!1}))}catch(t){b.error("LICENSES","Failed to delete license",t);const s=t instanceof Error?t.message:"Failed to delete license";throw e({error:s,loading:!1}),t}},clearError:()=>{e({error:null})}}));var D=s(2221),z=s(8077),U=s(9033),G=s(9400),K=s(9014),J=s(8080),B=s(3498),V=s(578),Y=s(4347),H=s(8589),Q=s(5368),W=s(2012),Z=s(8637),X=s(846),ee=s(6070);const te=(0,X.F)("inline-flex items-center justify-center rounded-lg text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{variants:{variant:{default:"bg-brand-500 text-white hover:bg-brand-600 shadow-sm",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-sm",outline:"border border-gray-300 bg-white hover:bg-gray-50 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 text-gray-900",link:"text-brand-600 underline-offset-4 hover:underline"},size:{default:"h-10 py-2 px-4",sm:"h-8 px-3 text-xs",lg:"h-12 px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),se=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...r},n)=>(0,ee.jsx)("button",{className:d(te({variant:t,size:s,className:e})),ref:n,...r}));se.displayName="Button";var ae=s(9716),re=s(1912),ne=s(4712);const ie=({citation:e,index:t,isExpanded:s,onToggle:a,onClick:r})=>(0,ee.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden transition-all hover:border-gray-300",children:[(0,ee.jsxs)("button",{onClick:a,className:"w-full px-3 py-2 flex items-center gap-3 hover:bg-gray-50 transition-colors text-left",children:[(0,ee.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded bg-brand-100 flex items-center justify-center",children:(0,ee.jsx)("span",{className:"text-xs font-medium text-brand-700",children:t})}),(0,ee.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ee.jsx)("div",{className:"font-medium text-sm text-gray-900 line-clamp-1",children:e.title}),(0,ee.jsx)("div",{className:"text-xs text-gray-500 line-clamp-1",children:e.source||e.url})]}),(0,ee.jsx)(re.A,{className:d("w-4 h-4 text-gray-400 transition-transform flex-shrink-0",s&&"rotate-180")})]}),(0,ee.jsx)(ae.N,{children:s&&(0,ee.jsx)(D.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,ee.jsxs)("div",{className:"px-3 py-2 border-t border-gray-100 bg-gray-50",children:[(0,ee.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:e.content}),e.confidence&&(0,ee.jsxs)("div",{className:"mb-2",children:[(0,ee.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[(0,ee.jsx)("span",{children:"Relevance"}),(0,ee.jsxs)("span",{children:[Math.round(100*e.confidence),"%"]})]}),(0,ee.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,ee.jsx)("div",{className:"bg-brand-500 h-1.5 rounded-full transition-all",style:{width:100*e.confidence+"%"}})})]}),(0,ee.jsxs)("div",{className:"flex items-center gap-2",children:[e.url&&(0,ee.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-brand-600 hover:text-brand-700 transition-colors",children:["View source",(0,ee.jsx)(V.A,{className:"w-3 h-3"})]}),r&&(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:()=>r(e),className:"h-6 px-2 text-xs",children:"View details"})]})]})})})]}),oe=({citations:e,onCitationClick:t,maxVisible:s=5,className:r})=>{const[n,i]=(0,a.useState)(new Set),[o,c]=(0,a.useState)(!1),l=o?e:e.slice(0,s),g=e.length>s;return 0===e.length?null:(0,ee.jsxs)("div",{className:d("mt-4 space-y-2",r),children:[(0,ee.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,ee.jsx)(ne.A,{className:"w-4 h-4"}),(0,ee.jsx)("span",{className:"font-medium",children:"Sources"}),(0,ee.jsxs)("span",{className:"text-gray-400",children:["(",e.length,")"]}),g&&(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:()=>c(!o),className:"ml-auto h-6 px-2 text-xs",children:o?"Show less":`Show all ${e.length}`})]}),(0,ee.jsx)("div",{className:"space-y-2",children:(0,ee.jsx)(ae.N,{children:l.map((e,s)=>(0,ee.jsx)(D.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,delay:.05*s},children:(0,ee.jsx)(ie,{citation:e,index:s+1,isExpanded:n.has(e.id),onToggle:()=>(e=>{const t=new Set(n);n.has(e)?t.delete(e):t.add(e),i(t)})(e.id),onClick:t})},e.id))})}),g&&!o&&(0,ee.jsx)("div",{className:"pt-2",children:(0,ee.jsxs)(se,{size:"sm",variant:"outline",onClick:()=>c(!0),className:"w-full",children:["Show ",e.length-s," more sources"]})})]})},ce=({language:e,value:t})=>{const[s,r]=(0,a.useState)(!1);return(0,ee.jsxs)("div",{className:"relative group",children:[(0,ee.jsx)("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:async()=>{await h(t)&&(r(!0),n.oR.success("Code copied to clipboard"),setTimeout(()=>r(!1),2e3))},className:"h-6 px-2 text-xs bg-gray-800 text-white hover:bg-gray-700",children:s?"Copied!":"Copy"})}),(0,ee.jsx)(J.A,{language:e,style:B.A,customStyle:{margin:0,borderRadius:"0.5rem",fontSize:"0.875rem"},children:t})]})},le=()=>(0,ee.jsx)("span",{className:"inline-block w-0.5 h-4 bg-gray-900 animate-blink ml-0.5 align-middle"}),de=({content:e,isStreaming:t})=>(0,ee.jsxs)("div",{className:"prose prose-sm max-w-none text-gray-900",children:[(0,ee.jsx)(G.oz,{remarkPlugins:[K.A],components:{code({className:e,children:t,...s}){const a=/language-(\w+)/.exec(e||"");return!!a&&a?(0,ee.jsx)(ce,{language:a[1],value:String(t).replace(/\n$/,""),...s}):(0,ee.jsx)("code",{className:"px-1 py-0.5 rounded bg-gray-100 text-sm font-medium",...s,children:t})},a:({href:e,children:t})=>(0,ee.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-brand-600 hover:text-brand-700 no-underline hover:underline inline-flex items-center gap-1",children:[t,(0,ee.jsx)(V.A,{className:"w-3 h-3"})]})},children:e}),t&&(0,ee.jsx)(le,{})]}),ge=({message:e,onFeedback:t})=>{const[s,r]=(0,a.useState)(e.feedback||null),i=e=>{r(e),t?.(e),n.oR.success("Thanks for your feedback!")};return(0,ee.jsxs)("div",{className:"mt-3 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:async()=>{await h(e.content)&&n.oR.success("Message copied to clipboard")},className:"h-8 w-8 text-gray-500 hover:text-gray-700",title:"Copy message",children:(0,ee.jsx)(Y.A,{className:"h-4 w-4"})}),(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:()=>i("like"),className:d("h-8 w-8 text-gray-500 hover:text-gray-700","like"===s&&"text-green-600 hover:text-green-700"),title:"Good response",children:(0,ee.jsx)(H.A,{className:"h-4 w-4"})}),(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:()=>i("dislike"),className:d("h-8 w-8 text-gray-500 hover:text-gray-700","dislike"===s&&"text-red-600 hover:text-red-700"),title:"Bad response",children:(0,ee.jsx)(Q.A,{className:"h-4 w-4"})}),(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:()=>{n.oR.info("Regenerating response...")},className:"h-8 w-8 text-gray-500 hover:text-gray-700",title:"Regenerate response",children:(0,ee.jsx)(W.A,{className:"h-4 w-4"})})]})},ue=({message:e,isStreaming:t=!1,isLast:s=!1,onCitationClick:a,onFeedback:r,className:n})=>{const i="user"===e.role;return(0,ee.jsx)(D.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:d("group relative px-4 py-6 transition-colors",i?"bg-white":"bg-gray-50 border-y border-gray-100","hover:bg-opacity-80",n),children:(0,ee.jsxs)("div",{className:"max-w-3xl mx-auto flex gap-4",children:[(0,ee.jsx)("div",{className:"flex-shrink-0",children:i?(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center",children:(0,ee.jsx)(Z.A,{className:"w-4 h-4 text-white"})}):(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center",children:(0,ee.jsx)(U.A,{className:"w-4 h-4 text-brand-600"})})}),(0,ee.jsxs)("div",{className:"flex-1 overflow-hidden",children:[e.status&&"sent"!==e.status&&(0,ee.jsxs)("div",{className:"mb-2 text-xs text-gray-500",children:["sending"===e.status&&"Sending...","error"===e.status&&(0,ee.jsx)("span",{className:"text-red-500",children:"Failed to send"})]}),i?(0,ee.jsx)("p",{className:"text-gray-900 whitespace-pre-wrap",children:e.content}):(0,ee.jsx)(de,{content:e.content,isStreaming:t}),e.citations&&e.citations.length>0&&(0,ee.jsx)(oe,{citations:e.citations,onCitationClick:a}),(0,ee.jsx)("div",{className:"mt-2 text-xs text-gray-400",children:m(e.timestamp)}),!i&&!t&&(0,ee.jsx)(ge,{message:e,onFeedback:r})]})]})})};var me=s(3429),he=s(999),pe=s(2020),ye=s(5476),fe=s(1016),xe=s(3897),ve=s(7052);const be=({file:e,onRemove:t})=>{const s=function(e){const t=e.toLowerCase();return t.includes("pdf")||t.includes("word")||t.includes("doc")?"":t.includes("text")||t.includes("txt")?"":t.includes("image")?"":t.includes("video")?"":t.includes("audio")?"":t.includes("excel")||t.includes("sheet")?"":t.includes("powerpoint")||t.includes("presentation")?"":t.includes("json")?"":t.includes("csv")?"":t.includes("zip")||t.includes("rar")?"":""}(e.type);return(0,ee.jsxs)(D.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[(0,ee.jsx)("div",{className:"text-gray-600",children:s}),(0,ee.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ee.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,ee.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[(0,ee.jsx)("span",{children:u(e.size)}),"uploading"===e.status&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("span",{children:""}),(0,ee.jsxs)("span",{children:[e.progress,"%"]})]}),"error"===e.status&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("span",{children:""}),(0,ee.jsxs)("span",{className:"text-red-500 flex items-center gap-1",children:[(0,ee.jsx)(he.A,{className:"w-3 h-3"}),"Error"]})]})]})]}),"uploading"===e.status&&(0,ee.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gray-200 rounded-b",children:(0,ee.jsx)("div",{className:"h-full bg-brand-500 rounded-b transition-all duration-300",style:{width:`${e.progress}%`}})}),(0,ee.jsx)("button",{onClick:t,className:"p-0.5 rounded hover:bg-gray-300 transition-colors",disabled:"uploading"===e.status,children:(0,ee.jsx)(pe.A,{className:"w-3 h-3 text-gray-500"})})]})},we=({onUpload:e,disabled:t})=>{const s=(0,a.useRef)(null);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("input",{ref:s,type:"file",multiple:!0,accept:f.ACCEPTED_FILE_TYPES.join(","),onChange:t=>{const s=Array.from(t.target.files||[]);s.length>0&&(e(s),t.target.value="")},className:"hidden"}),(0,ee.jsx)(se,{type:"button",size:"icon",variant:"ghost",onClick:()=>{s.current?.click()},disabled:t,className:"h-10 w-10 text-gray-600 hover:text-gray-800",title:"Upload files",children:(0,ee.jsx)(ye.A,{className:"h-5 w-5"})})]})},je=({onSend:e,disabled:t=!1,placeholder:s="Send a message...",maxLength:r=f.MAX_MESSAGE_LENGTH,className:i})=>{const[o,c]=(0,a.useState)(""),[l,m]=(0,a.useState)([]),[h,p]=(0,a.useState)(!1),y=(0,a.useRef)(null),x=(0,a.useCallback)(()=>{const e=y.current;if(e){e.style.height="auto";const t=e.scrollHeight,s=200;e.style.height=`${Math.min(t,s)}px`}},[]),v=s=>{if(s.preventDefault(),t)return;if(!o.trim()&&0===l.length)return;const a=l.filter(e=>"uploaded"===e.status).map(e=>new File([""],e.name,{type:e.type}));e(o.trim(),a),c(""),m([]),y.current&&(y.current.style.height="auto"),setTimeout(()=>{y.current?.focus()},0)},b=(0,a.useCallback)(e=>{const t=e.filter(e=>{return e.size>f.MAX_FILE_SIZE?(n.oR.error(`File "${e.name}" is too large. Maximum size is ${u(f.MAX_FILE_SIZE)}`),!1):(t=e.type,!!f.ACCEPTED_FILE_TYPES.some(e=>t.toLowerCase().includes(e.toLowerCase()))||(n.oR.error(`File type "${e.type}" is not supported`),!1));var t}).map(e=>({id:g(),name:e.name,size:e.size,type:e.type,status:"uploading",progress:0}));m(e=>[...e,...t]),t.forEach(e=>{w(e)})},[]),w=e=>{let t=0;const s=setInterval(()=>{t+=20*Math.random(),t>=100?(t=100,clearInterval(s),m(t=>t.map(t=>t.id===e.id?{...t,status:"uploaded",progress:100}:t))):m(s=>s.map(s=>s.id===e.id?{...s,progress:Math.round(t)}:s))},100)},{getRootProps:j,getInputProps:S,isDragActive:N}=(0,me.VB)({onDrop:b,noClick:!0,noKeyboard:!0,accept:f.ACCEPTED_FILE_TYPES.reduce((e,t)=>(e[t]=[],e),{}),maxSize:f.MAX_FILE_SIZE,onDragEnter:()=>p(!0),onDragLeave:()=>p(!1)}),A=!t&&(o.trim()||l.some(e=>"uploaded"===e.status));return(0,ee.jsxs)("div",{...j(),className:d("border-t border-gray-200 bg-white px-4 py-3 relative",N&&"bg-brand-50",i),children:[(0,ee.jsx)("input",{...S()}),(0,ee.jsx)(ae.N,{children:N&&(0,ee.jsx)(D.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-brand-50 border-2 border-dashed border-brand-300 rounded-lg flex items-center justify-center z-10",children:(0,ee.jsxs)("div",{className:"text-center",children:[(0,ee.jsx)(fe.A,{className:"w-8 h-8 text-brand-600 mx-auto mb-2"}),(0,ee.jsx)("p",{className:"text-brand-700 font-medium",children:"Drop files here to upload"}),(0,ee.jsx)("p",{className:"text-brand-600 text-sm",children:"Supports PDF, DOC, TXT, and more"})]})})}),(0,ee.jsx)(ae.N,{children:l.length>0&&(0,ee.jsx)(D.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-2 flex flex-wrap gap-2",children:l.map(e=>(0,ee.jsx)(be,{file:e,onRemove:()=>{return t=e.id,void m(e=>e.filter(e=>e.id!==t));var t}},e.id))})}),(0,ee.jsxs)("form",{onSubmit:v,className:"flex items-end gap-2",children:[(0,ee.jsx)(we,{onUpload:b,disabled:t}),(0,ee.jsxs)("div",{className:"flex-1 relative",children:[(0,ee.jsx)("textarea",{ref:y,value:o,onChange:e=>{const t=e.target.value;t.length<=r&&(c(t),x())},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v(e))},placeholder:s,disabled:t,rows:1,className:d("w-full resize-none rounded-lg border border-gray-300","px-3 py-2 pr-12","focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed","min-h-[44px] max-h-[200px]","placeholder:text-gray-500"),style:{height:"auto",overflowY:o.split("\n").length>5?"auto":"hidden"}}),o.length>0&&(0,ee.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400 pointer-events-none",children:[o.length,"/",r]})]}),(0,ee.jsx)(se,{type:"submit",size:"icon",disabled:!A,className:d("h-10 w-10 flex-shrink-0",t&&"animate-pulse"),title:t?"Stop generating":"Send message",children:t?(0,ee.jsx)(xe.A,{className:"h-5 w-5"}):(0,ee.jsx)(ve.A,{className:"h-5 w-5"})})]}),(0,ee.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500",children:[(0,ee.jsx)("span",{children:"Press Enter to send, Shift+Enter for new line"}),(0,ee.jsxs)("span",{children:["Supports ",f.ACCEPTED_FILE_TYPES.length,"+ file formats"]})]})]})},Se=({className:e})=>(0,ee.jsx)("div",{className:d("px-4 py-6 bg-gray-50 border-y border-gray-100",e),children:(0,ee.jsxs)("div",{className:"max-w-3xl mx-auto flex gap-4",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center flex-shrink-0",children:(0,ee.jsx)(U.A,{className:"w-4 h-4 text-brand-600"})}),(0,ee.jsxs)("div",{className:"flex items-center gap-1 py-2",children:[(0,ee.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle"}),(0,ee.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle delay-100"}),(0,ee.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce-subtle delay-200"})]})]})});var Ne=s(908),Ae=s(871),Ee=s(5294);const Ce=({agent:e,isSelected:t,onSelect:s,onSettingsClick:a})=>(0,ee.jsxs)("div",{className:d("flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors group","hover:bg-gray-50",t&&"bg-brand-50 hover:bg-brand-100"),onClick:()=>s(e),children:[(0,ee.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,ee.jsx)("div",{className:d("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",t?"bg-brand-600":"bg-gray-200"),children:(0,ee.jsx)(U.A,{className:d("w-4 h-4",t?"text-white":"text-gray-600")})}),(0,ee.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ee.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ee.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:e.project_name}),t&&(0,ee.jsx)(Ne.A,{className:"w-4 h-4 text-brand-600 flex-shrink-0"})]}),(0,ee.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-400",children:[e.settings?.chatbot_model&&(0,ee.jsxs)("span",{children:["Model: ",e.settings.chatbot_model]}),(0,ee.jsxs)("span",{children:["Status: ",e.is_chat_active?"Active":"Inactive"]})]})]})]}),a&&(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:t=>{t.stopPropagation(),a(e)},className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 text-gray-400 hover:text-gray-600",title:"Agent Settings",children:(0,ee.jsx)(Ae.A,{className:"h-3 w-3"})})]}),_e=({className:e,showSettings:t=!0,onSettingsClick:s})=>{const[r,i]=(0,a.useState)(!1),o=(0,a.useRef)(null),{agents:c,currentAgent:l,loading:g,error:u,fetchAgents:m,selectAgent:h}=I();(0,a.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};if(r)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r]);const p=async()=>{try{await m(),n.oR.success("Agents refreshed")}catch(e){n.oR.error("Failed to refresh agents")}},y=e=>{h(e),i(!1),n.oR.success(`Switched to ${e.project_name}`)};return g&&0===c.length?(0,ee.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,ee.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse"}),(0,ee.jsxs)("div",{className:"flex-1",children:[(0,ee.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2"}),(0,ee.jsx)("div",{className:"h-3 bg-gray-100 rounded animate-pulse w-3/4"})]})]})}):u&&0===c.length?(0,ee.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,ee.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:(0,ee.jsx)(he.A,{className:"w-4 h-4 text-red-600"})}),(0,ee.jsxs)("div",{className:"flex-1",children:[(0,ee.jsx)("p",{className:"text-sm text-red-600 font-medium",children:"Failed to load agents"}),(0,ee.jsx)("p",{className:"text-xs text-red-500",children:u})]}),(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:p,className:"text-red-600 hover:text-red-700",children:(0,ee.jsx)(Ee.A,{className:"w-4 h-4"})})]})}):l||0!==c.length?(0,ee.jsxs)("div",{className:d("relative",e),ref:o,children:[(0,ee.jsx)("button",{onClick:async()=>{const e=!r;if(i(e),e)try{await m()}catch(e){}},className:d("w-full p-3 bg-white border rounded-lg text-left transition-colors","hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",r&&"ring-2 ring-brand-500 border-transparent"),children:(0,ee.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ee.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-brand-600 flex items-center justify-center flex-shrink-0",children:(0,ee.jsx)(U.A,{className:"w-4 h-4 text-white"})}),(0,ee.jsx)("div",{className:"flex-1 min-w-0",children:(0,ee.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:l?.project_name||"Select Agent"})})]}),(0,ee.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:e=>{e.stopPropagation(),p()},disabled:g,className:"h-6 w-6 text-gray-400 hover:text-gray-600",title:"Refresh Agents",children:(0,ee.jsx)(Ee.A,{className:d("h-3 w-3",g&&"animate-spin")})}),(0,ee.jsx)(re.A,{className:d("w-4 h-4 text-gray-400 transition-transform",r&&"rotate-180")})]})]})}),(0,ee.jsx)(ae.N,{children:r&&(0,ee.jsx)(D.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full left-0 right-0 mt-2 bg-white border rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",children:(0,ee.jsxs)("div",{className:"p-2",children:[(0,ee.jsx)("div",{className:"px-2 py-1 mb-2",children:(0,ee.jsxs)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:["Available Agents (",Array.isArray(c)?c.length:0,")"]})}),(0,ee.jsx)("div",{className:"space-y-1",children:Array.isArray(c)&&c.length>0?c.map(e=>(0,ee.jsx)(Ce,{agent:e,isSelected:l?.id===e.id,onSelect:y,onSettingsClick:t?s:void 0},e.id)):(0,ee.jsxs)("div",{className:"px-2 py-4 text-center",children:[(0,ee.jsx)("p",{className:"text-sm text-gray-500",children:"No agents found"}),(0,ee.jsxs)(se,{size:"sm",variant:"ghost",onClick:p,className:"mt-2",children:[(0,ee.jsx)(Ee.A,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})})]})})})]}):(0,ee.jsx)("div",{className:d("p-3 bg-white border rounded-lg",e),children:(0,ee.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:(0,ee.jsx)(U.A,{className:"w-4 h-4 text-gray-600"})}),(0,ee.jsxs)("div",{className:"flex-1",children:[(0,ee.jsx)("p",{className:"text-sm text-gray-600 font-medium",children:"No agents available"}),(0,ee.jsx)("p",{className:"text-xs text-gray-500",children:"Check your API configuration"})]}),(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:p,disabled:g,children:(0,ee.jsx)(Ee.A,{className:d("w-4 h-4",g&&"animate-spin")})})]})})};var Ie=s(3373),Pe=s(6069),ke=s(354);const Me=({isOpen:e,onClose:t,citationId:s,projectId:r})=>{const[n,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(null),[g,u]=(0,a.useState)(!1),{currentAgent:m}=I(),h=r||m?.id;(0,a.useEffect)(()=>{e&&h&&s&&p()},[e,h,s]);const p=async()=>{if(h&&s){i(!0),c(null),u(!1);try{const e=A(),t=await e.getCitation(h,"string"==typeof s?parseInt(s,10):s);t.data&&(d(t.data),b.info("CITATION","Citation details fetched",{citationId:s,projectId:h,hasImage:!!t.data.image}))}catch(e){const t=e instanceof Error?e.message:"Failed to fetch citation details";c(t),b.error("CITATION","Failed to fetch citation details",{error:e,citationId:s,projectId:h})}finally{i(!1)}}else c("Missing project or citation information")};return e?(0,ee.jsx)(ae.N,{children:(0,ee.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,ee.jsx)(D.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/50"}),(0,ee.jsxs)(D.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[(0,ee.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,ee.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Citation Details"}),(0,ee.jsx)(se,{variant:"ghost",size:"icon",onClick:t,className:"h-8 w-8",children:(0,ee.jsx)(pe.A,{className:"h-4 w-4"})})]}),(0,ee.jsx)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:n?(0,ee.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,ee.jsx)(Ie.A,{className:"h-8 w-8 animate-spin text-gray-400"})}):o?(0,ee.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[(0,ee.jsx)(he.A,{className:"h-5 w-5 text-red-600 flex-shrink-0"}),(0,ee.jsxs)("div",{className:"flex-1",children:[(0,ee.jsx)("p",{className:"text-sm font-medium text-red-900",children:"Error loading citation"}),(0,ee.jsx)("p",{className:"text-sm text-red-700 mt-1",children:o})]})]}):l?(0,ee.jsxs)("div",{className:"space-y-4",children:[l.image&&!g&&(0,ee.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-gray-100",children:(0,ee.jsx)("img",{src:l.image,alt:l.title,className:"w-full h-auto",onError:()=>u(!0)})}),(0,ee.jsx)("div",{children:(0,ee.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:l.title})}),(0,ee.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,ee.jsx)(Pe.A,{className:"h-4 w-4"}),(0,ee.jsx)("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-brand-600 transition-colors truncate",children:l.url})]}),l.description&&(0,ee.jsx)("div",{className:"prose prose-gray max-w-none",children:(0,ee.jsx)("p",{className:"text-gray-700",children:l.description})}),(0,ee.jsxs)("div",{className:"pt-4 border-t space-y-2",children:[(0,ee.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ee.jsx)("span",{className:"text-gray-500",children:"Citation ID"}),(0,ee.jsxs)("span",{className:"font-mono text-gray-700",children:["#",l.id]})]}),l.image&&(0,ee.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ee.jsx)("span",{className:"text-gray-500",children:"Has preview image"}),(0,ee.jsx)(ke.A,{className:"h-4 w-4 text-gray-400"})]})]})]}):null}),(0,ee.jsx)("div",{className:"p-4 border-t bg-gray-50",children:(0,ee.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ee.jsx)("div",{className:"text-xs text-gray-500",children:"Open Graph data from cited source"}),l&&(0,ee.jsxs)("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-brand-600 hover:text-brand-700 transition-colors",children:["Visit source",(0,ee.jsx)(V.A,{className:"h-3.5 w-3.5"})]})]})})]})]})}):null};var Re=s(6424),Te=s(5854),$e=s(783),Le=s(9606);const Fe=({sessionId:e,maxConversations:t,currentConversationId:s,onConversationChange:r,onCreateConversation:n,className:i})=>{const[o,c]=(0,a.useState)([]),[l,g]=(0,a.useState)(null),[u,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const t=()=>{const t=localStorage.getItem(`customgpt_conversations_${e}`);if(t)try{const e=JSON.parse(t);c(e)}catch(e){}};return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]);const y=t=>{const s=o.map(e=>e.id===t?{...e,title:u}:e);c(s),localStorage.setItem(`customgpt_conversations_${e}`,JSON.stringify(s)),g(null)},f=o.find(e=>e.id===s);return(0,ee.jsxs)("div",{className:d("relative",i),children:[(0,ee.jsxs)("button",{onClick:()=>p(!h),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors w-full",children:[(0,ee.jsx)(Re.A,{className:"w-4 h-4"}),(0,ee.jsx)("span",{className:"truncate flex-1 text-left",children:f?.title||"Select Conversation"}),(0,ee.jsx)("svg",{className:d("w-4 h-4 transition-transform",h&&"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ee.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,ee.jsx)(ae.N,{children:h&&(0,ee.jsxs)(D.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-80 overflow-y-auto",children:[(0,ee.jsxs)("button",{onClick:()=>{t&&o.length>=t?alert(`Maximum conversation limit (${t}) reached`):n?.()},disabled:!!t&&o.length>=t,className:"flex items-center gap-2 w-full px-4 py-3 text-sm font-medium text-brand-600 hover:bg-brand-50 disabled:opacity-50 disabled:cursor-not-allowed border-b",children:[(0,ee.jsx)(Te.A,{className:"w-4 h-4"}),"New Conversation"]}),(0,ee.jsx)("div",{className:"py-2",children:o.map(t=>(0,ee.jsx)("div",{className:d("group flex items-center px-4 py-2 hover:bg-gray-50",s===t.id&&"bg-brand-50"),children:l===t.id?(0,ee.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,ee.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"===e.key&&y(t.id),"Escape"===e.key&&g(null)},className:"flex-1 px-2 py-1 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-brand-500",autoFocus:!0}),(0,ee.jsx)("button",{onClick:()=>y(t.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:(0,ee.jsx)(Ne.A,{className:"w-4 h-4"})}),(0,ee.jsx)("button",{onClick:()=>g(null),className:"p-1 text-gray-400 hover:bg-gray-100 rounded",children:(0,ee.jsx)(pe.A,{className:"w-4 h-4"})})]}):(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)("button",{onClick:()=>(e=>{r?.(e),p(!1)})(t),className:"flex-1 text-left",children:[(0,ee.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.title}),(0,ee.jsx)("div",{className:"text-xs text-gray-500",children:new Date(t.createdAt).toLocaleDateString()})]}),(0,ee.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,ee.jsx)("button",{onClick:()=>(e=>{g(e.id),m(e.title)})(t),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",children:(0,ee.jsx)($e.A,{className:"w-3 h-3"})}),(0,ee.jsx)("button",{onClick:()=>(t=>{if(o.length<=1)return void alert("Cannot delete the last conversation");const a=o.filter(e=>e.id!==t);c(a),localStorage.setItem(`customgpt_conversations_${e}`,JSON.stringify(a)),s===t&&a.length>0&&r?.(a[0])})(t.id),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",children:(0,ee.jsx)(Le.A,{className:"w-3 h-3"})})]})]})},t.id))})]})})]})},Oe=["What can you help me with?","Explain this document","Summarize key points","Answer my questions"],qe=({prompt:e,onClick:t})=>(0,ee.jsx)("button",{onClick:()=>t(e),className:"p-3 text-left bg-white border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all text-sm text-gray-700",children:e}),De=({onPromptClick:e})=>{const{currentAgent:t}=I();return(0,ee.jsx)("div",{className:"flex flex-col items-center justify-center h-full px-4 py-8",children:(0,ee.jsxs)(D.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md",children:[(0,ee.jsx)("div",{className:"w-16 h-16 rounded-full bg-brand-100 flex items-center justify-center mb-6 mx-auto",children:(0,ee.jsx)(z.A,{className:"w-8 h-8 text-brand-600"})}),(0,ee.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:["Welcome to ",t?.project_name||"CustomGPT","!"]}),(0,ee.jsx)("p",{className:"text-gray-600 mb-8",children:"I'm here to help answer your questions and assist with your tasks. How can I help you today?"}),(0,ee.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 w-full",children:Oe.map((t,s)=>(0,ee.jsx)(D.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1+.1*s},children:(0,ee.jsx)(qe,{prompt:t,onClick:e})},s))})]})})},ze=({className:e})=>{const{messages:t,streamingMessage:s,isStreaming:r,error:n,sendMessage:i}=L(),{currentConversation:o}=P(),{currentAgent:c}=I(),l=(0,a.useRef)(null),[g,u]=a.useState(null),[m,h]=a.useState(!1),p=o&&t.get(o.id.toString())||[];(0,a.useEffect)(()=>{l.current&&l.current.scrollTo({top:l.current.scrollHeight,behavior:"smooth"})},[p,s]);const y=e=>{b.info("UI","Citation clicked",{citationId:e.id,citationIndex:e.index,citationTitle:e.title}),e.id&&(u(e.id),h(!0))};return(0,ee.jsxs)("div",{ref:l,className:d("flex-1 overflow-y-auto scroll-smooth","bg-gradient-to-b from-gray-50 to-white",e),children:[n&&(0,ee.jsxs)("div",{className:"p-4 m-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,ee.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,ee.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ee.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,ee.jsx)("span",{className:"font-medium",children:n.includes("unauthorized")||n.includes("403")?"Authorization Error":"Error"})]}),(0,ee.jsx)("p",{className:"text-red-700 mt-1 text-sm",children:n.includes("unauthorized")||n.includes("403")?"Your API key does not have permission to access this agent's conversations. Please check your API key permissions or contact support.":n})]}),0===p.length&&!s&&!n&&(0,ee.jsx)(De,{onPromptClick:e=>{b.info("UI","Example prompt clicked",{prompt:e}),i(e)}}),p.length>0&&(0,ee.jsx)("div",{className:"space-y-0",children:p.map((e,t)=>(0,ee.jsx)(ue,{message:e,isLast:t===p.length-1,onCitationClick:y,onFeedback:t=>((e,t)=>{b.info("UI","Message feedback provided",{messageId:e,feedback:t})})(e.id,t)},e.id))}),s&&(0,ee.jsx)(ue,{message:s,isStreaming:!0,isLast:!0,onCitationClick:y}),r&&!s&&(0,ee.jsx)(Se,{}),g&&(0,ee.jsx)(Me,{isOpen:m,onClose:()=>{h(!1),u(null)},citationId:g,projectId:c?.id})]})},Ue=({mode:e="standalone",onClose:t,onAgentSettings:s,enableConversationManagement:a=!1,maxConversations:r,sessionId:n,currentConversationId:i,onConversationChange:o,onCreateConversation:c})=>{const{currentAgent:l}=I();return"widget"===e||"floating"===e?(0,ee.jsxs)("header",{className:"border-b border-gray-200 bg-white",children:[a&&n&&(0,ee.jsx)("div",{className:"px-4 py-2 border-b border-gray-100",children:(0,ee.jsx)(Fe,{sessionId:n,maxConversations:r,currentConversationId:i,onConversationChange:o,onCreateConversation:c,className:"w-full"})}),(0,ee.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,ee.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center flex-shrink-0",children:(0,ee.jsx)(U.A,{className:"w-5 h-5 text-white"})}),(0,ee.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,ee.jsx)("h2",{className:"font-semibold text-gray-900 truncate",children:l?.project_name||"CustomGPT Assistant"}),(0,ee.jsx)("p",{className:"text-xs text-gray-500",children:l?.is_chat_active?"Online":"Offline"})]})]}),t&&(0,ee.jsxs)("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors flex-shrink-0",children:[(0,ee.jsx)("span",{className:"sr-only",children:"Close"}),""]})]})]}):"standalone"===e?(0,ee.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-white",children:[(0,ee.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ee.jsx)("div",{className:"w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center",children:(0,ee.jsx)(U.A,{className:"w-5 h-5 text-white"})}),(0,ee.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Agent Chat"})]}),(0,ee.jsx)("div",{className:"flex-1 max-w-xs ml-4",children:(0,ee.jsx)(_e,{onSettingsClick:s,className:"w-full"})})]}):null},Ge=({mode:e="standalone",className:t,onClose:s,onAgentSettings:r,enableConversationManagement:n=!1,maxConversations:i,sessionId:o,threadId:c,onConversationChange:l,onMessage:g})=>{const{sendMessage:u,isStreaming:m,cancelStreaming:h}=L(),{fetchAgents:p,agents:y,currentAgent:f}=I(),{currentConversation:x}=P(),[v,w]=a.useState(null);(0,a.useEffect)(()=>{(async()=>{if(0!==y.length||f)b.debug("UI","Agents already initialized",{agentCount:y.length,hasCurrentAgent:!!f,currentAgentName:f?.project_name});else{b.info("UI","Initializing agents on ChatContainer mount");try{await p(),b.info("UI","Agents initialized successfully",{agentCount:y.length})}catch(e){b.error("UI","Failed to initialize agents",e,{errorMessage:e instanceof Error?e.message:String(e)})}}})()},[]);return(0,ee.jsxs)("div",{className:d("flex flex-col bg-white","standalone"===e&&"h-full","widget"===e&&"h-[600px] w-[400px] rounded-lg shadow-xl border border-gray-200","floating"===e&&"h-[600px] w-[400px] rounded-lg shadow-2xl border border-gray-200",t),children:[(0,ee.jsx)(Ue,{mode:e,onClose:s,onAgentSettings:e=>{b.info("UI","Agent settings requested",{agentId:e.id,agentName:e.project_name}),r?.(e)},enableConversationManagement:n,maxConversations:i,sessionId:o,currentConversationId:v||x?.id.toString(),onConversationChange:e=>{if(w(e.id),l?.(e),"undefined"!=typeof window&&window.CustomGPTWidget){const t=window.__customgpt_widget_instance;t&&t.switchConversation(e.id)}},onCreateConversation:()=>{if("undefined"!=typeof window&&window.CustomGPTWidget){const e=window.__customgpt_widget_instance;if(e){const t=e.createConversation();w(t.id)}}}}),(0,ee.jsx)(ze,{className:"flex-1"}),(0,ee.jsx)(je,{onSend:async(e,t)=>{b.info("UI","Sending message from ChatContainer",{contentLength:e.length,hasFiles:t&&t.length>0,fileCount:t?.length||0,currentAgent:f?.project_name,agentId:f?.id});try{await u(e,t),b.info("UI","Message sent successfully")}catch(e){b.error("UI","Failed to send message from ChatContainer",e,{errorMessage:e instanceof Error?e.message:String(e),isAuthError:e instanceof Error&&(e.message.includes("403")||e.message.includes("unauthorized"))})}},disabled:m,placeholder:m?"AI is thinking...":"Send a message..."}),("widget"===e||"floating"===e)&&(0,ee.jsx)("div",{className:"px-4 py-2 border-t border-gray-100 bg-gray-50",children:(0,ee.jsx)("a",{href:"https://customgpt.ai",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500 hover:text-gray-700 transition-colors block text-center",children:"Powered by CustomGPT.ai"})})]})};var Ke=s(7600),Je=s.n(Ke),Be=s(3252),Ve=s(348),Ye=s(6846),He=s(2923),Qe=s(3458),We=s(1216),Ze=s(9666),Xe=s(4004),et=s(9062);const tt=({conversation:e,isSelected:t,onSelect:s,onDelete:r,onRename:n})=>{const[i,o]=(0,a.useState)(!1),[c,l]=(0,a.useState)(e.name),[g,u]=(0,a.useState)(!1),h=(0,a.useRef)(null),p=(0,a.useRef)(null);(0,a.useEffect)(()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&u(!1)};if(g)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[g]),(0,a.useEffect)(()=>{i&&h.current&&(h.current.focus(),h.current.select())},[i]);const y=()=>{c.trim()&&c.trim()!==e.name&&n(e.id.toString(),c.trim()),o(!1),l(e.name)};return(0,ee.jsx)("div",{className:d("group relative p-3 rounded-lg cursor-pointer transition-colors","hover:bg-gray-50",t&&"bg-brand-50 hover:bg-brand-100"),onClick:()=>!i&&s(e),children:(0,ee.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,ee.jsxs)("div",{className:"flex-1 min-w-0",children:[i?(0,ee.jsx)("input",{ref:h,type:"text",value:c,onChange:e=>l(e.target.value),onBlur:y,onKeyDown:t=>{"Enter"===t.key?y():"Escape"===t.key&&(o(!1),l(e.name))},className:"w-full px-2 py-1 text-sm font-medium text-gray-900 bg-white border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",maxLength:100}):(0,ee.jsx)("h3",{className:"font-medium text-gray-900 text-sm truncate",children:e.name}),(0,ee.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[(0,ee.jsx)(Be.A,{className:"w-3 h-3"}),(0,ee.jsx)("span",{children:m(e.updated_at)}),e.message_count&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("span",{children:""}),(0,ee.jsxs)("span",{children:[e.message_count," messages"]})]})]})]}),!i&&(0,ee.jsxs)("div",{className:"relative",ref:p,children:[(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:e=>{e.stopPropagation(),u(!g)},className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 text-gray-400 hover:text-gray-600",children:(0,ee.jsx)(Ve.A,{className:"h-3 w-3"})}),(0,ee.jsx)(ae.N,{children:g&&(0,ee.jsx)(D.P.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},transition:{duration:.1},className:"absolute right-0 top-6 mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,ee.jsxs)("div",{className:"py-1",children:[(0,ee.jsxs)("button",{onClick:e=>{e.stopPropagation(),o(!0),u(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,ee.jsx)(Ye.A,{className:"w-3 h-3"}),"Rename"]}),(0,ee.jsxs)("button",{onClick:t=>{t.stopPropagation(),r(e.id.toString()),u(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,ee.jsx)(Le.A,{className:"w-3 h-3"}),"Delete"]})]})})})]})]})})},st=({className:e,isCollapsed:t=!1,onToggle:s})=>{const[r,i]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),{conversations:l,currentConversation:g,loading:u,error:m,fetchConversations:h,createConversation:p,selectConversation:y,deleteConversation:f,updateConversation:x}=P(),{currentAgent:v}=I(),{clearMessages:w,loadMessages:j}=L();(0,a.useEffect)(()=>{const e="undefined"!=typeof window&&window.__customgpt_demo_mode;v&&!e?(b.info("UI","Agent changed in sidebar, fetching conversations",{agentId:v.id,agentName:v.project_name,isActive:v.is_chat_active}),h(v.id)):v?e&&b.info("UI","Skipping conversation fetch in demo mode"):b.warn("UI","No current agent selected in sidebar")},[v,h]),Array.isArray(l);const S=Array.isArray(l)?l.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())):[],N=async e=>{b.info("UI","Selecting conversation",{conversationId:e.id,conversationName:e.name,projectId:e.project_id,messageCount:e.message_count}),y(e);try{b.info("UI","Loading messages for selected conversation",{conversationId:e.id,agentId:v?.id,agentName:v?.project_name}),await j(e.id.toString()),b.info("UI","Messages loaded successfully for conversation",{conversationId:e.id})}catch(t){b.error("UI","Failed to load messages for conversation",t,{conversationId:e.id,errorMessage:t instanceof Error?t.message:String(t),errorType:t instanceof Error?t.constructor.name:typeof t}),n.oR.error("Failed to load conversation messages")}},A=async(e,t)=>{const s=l.find(t=>t.id.toString()===e);if(s)try{await x(s.project_id,s.session_id,{name:t}),n.oR.success("Conversation renamed")}catch(e){n.oR.error("Failed to rename conversation")}};return t?(0,ee.jsx)("div",{className:d("w-12 bg-gray-50 border-r border-gray-200 flex flex-col",e),children:(0,ee.jsx)("div",{className:"p-2",children:(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:s,className:"w-8 h-8",title:"Expand sidebar",children:(0,ee.jsx)(He.A,{className:"h-4 w-4"})})})}):(0,ee.jsxs)("div",{className:d("w-80 bg-gray-50 border-r border-gray-200 flex flex-col",e),children:[(0,ee.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-white",children:[(0,ee.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ee.jsx)("h2",{className:"font-semibold text-gray-900",children:"Conversations"}),(0,ee.jsx)(se,{size:"icon",variant:"ghost",onClick:s,className:"h-8 w-8",title:"Collapse sidebar",children:(0,ee.jsx)(pe.A,{className:"h-4 w-4"})})]}),(0,ee.jsxs)("div",{className:"relative",children:[(0,ee.jsx)(Qe.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,ee.jsx)("input",{type:"text",placeholder:"Search conversations...",value:r,onChange:e=>i(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent"})]})]}),(0,ee.jsxs)("div",{className:"p-4 space-y-2",children:[(0,ee.jsx)(Je(),{href:"/create",children:(0,ee.jsxs)(se,{className:"w-full justify-start gap-2",variant:"default",children:[(0,ee.jsx)(U.A,{className:"w-4 h-4"}),"Create New Agent"]})}),(0,ee.jsxs)(se,{onClick:async()=>{if(v&&!o){b.info("UI","Creating new conversation",{agentId:v.id,agentName:v.project_name}),c(!0);try{const e=`New Chat ${(new Date).toLocaleDateString()}`;await p(v.id,e),w(),b.info("UI","New conversation created successfully",{name:e}),n.oR.success("New conversation created")}catch(e){b.error("UI","Failed to create conversation",e,{agentId:v.id,errorMessage:e instanceof Error?e.message:String(e)}),n.oR.error("Failed to create new conversation")}finally{c(!1)}}},disabled:!v||o,className:"w-full justify-start gap-2",variant:"outline",children:[(0,ee.jsx)(Te.A,{className:"w-4 h-4"}),o?"Creating...":"New Chat"]}),(0,ee.jsxs)("div",{className:"border-t border-gray-200 pt-2 mt-3 space-y-1",children:[(0,ee.jsx)(Je(),{href:"/analytics",children:(0,ee.jsxs)(se,{className:"w-full justify-start gap-2",variant:"ghost",size:"sm",children:[(0,ee.jsx)(We.A,{className:"w-4 h-4"}),"Analytics"]})}),(0,ee.jsx)(Je(),{href:"/pages",children:(0,ee.jsxs)(se,{className:"w-full justify-start gap-2",variant:"ghost",size:"sm",children:[(0,ee.jsx)(Ze.A,{className:"w-4 h-4"}),"Pages"]})}),(0,ee.jsx)(Je(),{href:"/sources",children:(0,ee.jsxs)(se,{className:"w-full justify-start gap-2",variant:"ghost",size:"sm",children:[(0,ee.jsx)(Xe.A,{className:"w-4 h-4"}),"Sources"]})}),(0,ee.jsx)(Je(),{href:"/debug",children:(0,ee.jsxs)(se,{className:"w-full justify-start gap-2",variant:"ghost",size:"sm",children:[(0,ee.jsx)(et.A,{className:"w-4 h-4"}),"Debug Logs"]})})]}),(0,ee.jsxs)(se,{onClick:()=>{v&&(b.info("UI","Manual refresh conversations clicked",{agentId:v.id,agentName:v.project_name}),h(v.id))},disabled:!v||u,className:"w-full justify-start gap-2",variant:"ghost",size:"sm",children:[(0,ee.jsx)(Ee.A,{className:d("w-4 h-4",u&&"animate-spin")}),"Refresh Conversations"]})]}),(0,ee.jsx)("div",{className:"flex-1 overflow-y-auto",children:!u||Array.isArray(l)&&0!==l.length?!m||Array.isArray(l)&&0!==l.length?0===S.length?(0,ee.jsxs)("div",{className:"p-4 text-center",children:[(0,ee.jsx)(He.A,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,ee.jsx)("p",{className:"text-sm text-gray-500",children:r?"No conversations found":"No conversations yet"}),!r&&(0,ee.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Start a new conversation to get going"}),v&&(0,ee.jsxs)("div",{className:"text-xs text-gray-400 mt-2 space-y-1",children:[(0,ee.jsxs)("p",{children:["Agent: ",v.project_name," (ID: ",v.id,")"]}),m&&(0,ee.jsxs)("p",{className:"text-red-500",children:["Error: ",m]}),(0,ee.jsxs)("p",{children:["Conversations loaded: ",l.length]})]})]}):(0,ee.jsx)("div",{className:"p-2 space-y-1",children:S.map(e=>(0,ee.jsx)(tt,{conversation:e,isSelected:g?.id===e.id,onSelect:N,onDelete:e=>(async e=>{try{await f(e),n.oR.success("Conversation deleted")}catch(e){n.oR.error("Failed to delete conversation")}})(e),onRename:A},e.id))}):(0,ee.jsxs)("div",{className:"p-4 text-center",children:[(0,ee.jsx)("p",{className:"text-sm text-red-600 mb-2",children:"Failed to load conversations"}),(0,ee.jsx)(se,{size:"sm",variant:"ghost",onClick:()=>v&&h(v.id),children:"Try Again"})]}):(0,ee.jsx)("div",{className:"p-4 space-y-3",children:[...Array(3)].map((e,t)=>(0,ee.jsxs)("div",{className:"animate-pulse",children:[(0,ee.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,ee.jsx)("div",{className:"h-3 bg-gray-100 rounded w-3/4"})]},t))})}),(0,ee.jsx)("div",{className:"p-4 border-t border-gray-200 bg-white",children:(0,ee.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[S.length," conversation",1!==S.length?"s":"",v&&(0,ee.jsxs)("span",{className:"block mt-1",children:["Agent: ",v.project_name]})]})})]})},at=({mode:e="standalone",className:t,onClose:s,onAgentSettings:r,showSidebar:n=!0,enableConversationManagement:i=!1,maxConversations:o,sessionId:c,threadId:l,onConversationChange:d,onMessage:g})=>{const[u,m]=(0,a.useState)(!1),{currentConversation:h}=P(),{loadMessages:p}=L();(0,a.useEffect)(()=>{const e="undefined"!=typeof window&&window.__customgpt_demo_mode;h&&!e&&p(h.id.toString())},[h,p]);return n&&"standalone"===e?(0,ee.jsxs)("div",{className:"flex h-full bg-white",children:[(0,ee.jsx)(st,{isCollapsed:u,onToggle:()=>{m(!u)}}),(0,ee.jsx)("div",{className:"flex-1 flex flex-col min-w-0",children:(0,ee.jsx)(Ge,{mode:e,className:"h-full",onClose:s,onAgentSettings:r,enableConversationManagement:i,maxConversations:o,sessionId:c,threadId:l,onConversationChange:d,onMessage:g})})]}):(0,ee.jsx)(Ge,{mode:e,className:t,onClose:s,onAgentSettings:r,enableConversationManagement:i,maxConversations:o,sessionId:c,threadId:l,onConversationChange:d,onMessage:g})},rt=()=>{const[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=new URLSearchParams(window.location.search),s=e.get("agentId"),a={apiKey:e.get("apiKey")||"",agentId:s?isNaN(Number(s))?s:Number(s):"",mode:e.get("mode")||"embedded",theme:e.get("theme")||"light",enableCitations:"false"!==e.get("enableCitations"),enableFeedback:"false"!==e.get("enableFeedback")};if(!a.apiKey)return;if(!a.agentId)return;t(a),_.getState().setApiKey(a.apiKey);const n={id:"string"==typeof a.agentId?parseInt(a.agentId):a.agentId,project_name:`Agent ${a.agentId}`,is_chat_active:!0};I.getState().selectAgent(n),i(),o("ready",{config:a}),r(!0)},[]);const i=()=>{window.addEventListener("message",e=>{const{type:t,data:s}=e.data;switch(t){case"customgpt-open":c();break;case"customgpt-close":l();break;case"customgpt-config-update":d(s)}});const e=()=>{o("resize",{width:window.innerWidth,height:window.innerHeight})};window.addEventListener("resize",e),setTimeout(e,100)},o=(e,t={})=>{window.parent&&window.parent!==window&&window.parent.postMessage({type:`customgpt-${e}`,data:t},"*")},c=()=>{},l=()=>{o("close")},d=s=>{if(e){const a={...e,...s};t(a),s.apiKey&&_.getState().setApiKey(s.apiKey)}};return e&&s?(0,ee.jsxs)("div",{className:"h-screen bg-gray-50",children:[(0,ee.jsx)(at,{mode:"widget",showSidebar:!1,onClose:"floating"===e.mode?l:void 0}),(0,ee.jsx)(n.l$,{position:"top-center",toastOptions:{style:{zIndex:1e4}}})]}):(0,ee.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:(0,ee.jsxs)("div",{className:"text-center",children:[(0,ee.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,ee.jsx)("p",{className:"text-gray-600",children:"Loading CustomGPT..."})]})})},nt=()=>{const e=document.getElementById("iframe-app");if(e){(0,r.H)(e).render((0,ee.jsx)(rt,{}))}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",nt):nt()}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var n=s[e]={exports:{}};return t[e].call(n.exports,n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,s,r,n)=>{if(!s){var i=1/0;for(d=0;d<e.length;d++){for(var[s,r,n]=e[d],o=!0,c=0;c<s.length;c++)(!1&n||i>=n)&&Object.keys(a.O).every(e=>a.O[e](s[c]))?s.splice(c--,1):(o=!1,n<i&&(i=n));if(o){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,r,n]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={437:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var r,n,[i,o,c]=s,l=0;if(i.some(t=>0!==e[t])){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(c)var d=c(a)}for(t&&t(s);l<i.length;l++)n=i[l],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=self.webpackChunkcustomgpt_ui=self.webpackChunkcustomgpt_ui||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=a.O(void 0,[96],()=>a(4085));r=a.O(r)})();
//# sourceMappingURL=iframe-app.js.map